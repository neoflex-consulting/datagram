## Интерфейс Neoflex Datagram

### Главная страница

![](C:/D/SVN/DOC/MD%20manual/UserManualRU/Pic/MainPage_2.png)

**Панель навигации**. На панели расположены ссылки для перехода в разделы программы.

**Рабочая область**. На главной странице в рабочей области расположены панели со списком последних просмотренных объектов, списки подключенных серверов Oozie и Zeppelin. При переходе в какой-либо раздел интерфейса в рабочей области отобразится список объектов программы, относящихя к выбранному разделу, и их атрибуты. 

**Редактирование таблицы**

Колонки таблицы, в которых отображаются атрибуты объектов, можно настроить. Окно настройки открывается по кнопке **«Колонки»** !(media/image33.png){width="0.3279997812773403in" height="0.2952001312335958in"}, расположенной в правом верхнем углу таблицы.

При помощи списка, расположенного в нижней части таблицы, можно установить количество строк, выводимых на одной странице. Для перелистывания страниц используйте кнопки **«Вперед»** и **«Назад».**

**Работа с объектами**

В рабочей области расположены кнопки, позволяющие выполнять действия с объектами:

!(media/image8.png){width="0.4391305774278215in" height="0.29275371828521435in"} (Создать) - по кнопке выполняется переход в форму создания нового объекта;

!(media/image34.png){width="0.34782589676290465in" height="0.3229811898512686in"} (Просмотреть) - открывает форму просмотра свойств объекта;

!(media/image35.png){width="0.36521762904636923in" height="0.32795056867891514in"} (Редактировать) - по кнопке открывается форма редактирования свойств объекта;

!(media/image36.png){width="0.343999343832021in" height="0.3272189413823272in"} (Копировать) - при нажатии кнопки будет создана копия объекта с названием «Копия\_\[Имя исходного объекта\]»;

!(media/image37.png){width="0.3629352580927384in" height="0.30519575678040245in"} (Удалить) - по кнопке выполняется удаление объекта.

### Консоль HDFS

**Консоль HDFS** - файловый менеджер HDFS.

**Консоль HDFS** позволяет работать с объектами в файловой системе HDFS:

- Загрузка файлов - !(media/image38.png){width="0.3217399387576553in" height="0.2869575678040245in"};
- Удаление - !(media/image37.png){width="0.3323228346456693in" height="0.27945319335083113in"};
- Обновление данных на странице - !(media/image39.png){width="0.30355643044619424in" height="0.2782600612423447in"}.

Для выбора нужной файловой системы HDFS в списке, расположенном над таблицей, выберите объект **LivyServer**, в параметрах которого указана нужная файловая система (на рисунке 19 - это «LivyOnCloud2»).

!(media/image40.png){width="6.396938976377953in" height="3.480062335958005in"}

Рисунок {#Рис_HDFS_Console .anchor}19. Подсистема Консоль HDFS

### Консоль Livy

В **Консоли Livy** отображается информация о результатах исполнения объектов **Transformation**.

!(media/image41.png){width="6.397777777777778in" height="3.3393503937007876in"}

Рисунок {#Рис_LivyConsole .anchor}20. Подсистема Консоль Livy

Для получения информации об объектах **Transformation** в интерфейсе подсистемы **Консоль** **Livy** в списке **Server** необходимо выбрать **Livy Server**, на котором исполнялись объекты.

Информация выводится на вкладках:

- **Session** - данные об исполнении трансформаций, которые были запущены из [редактора кода трансформации](#редактор-кода-трансформации). Исполнение трансформаций, входящих в одну сессию, можно прекратить нажатием кнопки **«Kill»**, расположенной в столбце **Commands** (рис. 20);
- **Batches** - данные об исполнении трансформаций, запущенных из интерфейса дизайнера диаграмм трансформации. Исполнение трансформации можно остановить нажатием кнопки **«Cancel»**, расположенной в столбце **Commands**;
- **Details** - информация о выбранном Livy Server.

> !(media/image3.png){width="0.5347222222222222in" height="0.5659722222222222in"}*На заметку.*
>
> *Исполняющая среда Server Livy хранит записи об исполнении объектов определенное время, а затем удаляет. Таким образом, данные, отображаемые на вкладках **Session** и **Batches**, автоматически очищаются.*

На вкладках **Session** и **Batches** в столбце **Commands** расположены ссылки **«Driver Log»** и **«Spark UI»**, которые открывают страницы протоколирования работы драйвера Hadoop и веб-консоль Spark соответственно.

Для обновления информации на вкладках используйте кнопку **«Refresh»**.

### Консоль Oozie

В интерфейсе подсистемы **Консоль Oozie** выводится информация о результатах исполнения объектов **Workflow** и **CoJob**.

!(media/image30.png){width="5.41599956255468in" height="3.1195100612423445in"}

Рисунок {#Рис_Oozie_Console .anchor}]{#Рис_DBMonitor .anchor}21. Подсистема Консоль Oozie

Для получения информации об исполнении объектов в интерфейсе подсистемы **Консоль** **Oozie** необходимо настроить фильтр (рис. 21):

- **«Oozie» -** из списка выбирается необходимый сервер;
- **«Task Type»** выбирается одно из значений:

**Workflow active** - выводятся данные об объектах Workflow, исполнение которые еще не завершено;

- **Workflow all** - выводятся данные обо всех объектах Workflow;
- **Coordinator active** - выводятся данные об объектах CoJob, исполнение которые еще не завершено;
- **Coordinator all** - выводятся данные обо всех объектах CoJob.

<!-- -->

- В полях **«From»** и **«To»** устанавливается интервал дат, за который будут представлены данные.

Информация об объектах **Workflow** и **CoJob** выводится в виде таблицы со столбцами (рис. 21):

- **Name** - название объекта;
- **Id** - идентификатор задачи, который присваивается автоматически исполняющей средой;
- **Status** - статус, в котором объект находится в данный момент;
- **Start** - дата и время запуска исполнения объекта;
- **Finish** - дата и время завершения исполнения объекта (актуально для объектов со статусами: Succeeded, Ok, Failed, Error, Killed);
- **Duration** - продолжительность исполнения объекта (актуально для объектов со статусами: Succeeded, Ok, Failed, Error, Killed);

<!-- -->

- **Type** - тип объекта.

Любой объект, представленный в таблице, можно перезапустить и/или остановить его исполнение - кнопки «**Rerun task**» !(media/image42.png){width="0.30875656167979004in" height="0.2786340769903762in"} и «**Kill task**» !(media/image43.png){width="0.32864720034995626in" height="0.303999343832021in"} соответственно.

**Информация об объектах Workflow и CoJob**

Для просмотра подробной информации необходимо развернуть соответствующий объект (рис. 22).

!(media/image44.png){width="6.300005468066492in" height="1.2240004374453193in"}

Рисунок {#Рис_Подробно_об_объекте .anchor}22. Подробная информация об объекте Workflow

На вкладках будет представлена следующая информация:

- **Child tasks** - элементы, входящих в состав диаграммы, описывающей логику работы объекта Workflow или элемент CoordinatorAction описывающий объект CoJob. Если развернуть любой элемент, то для него будет выведена информация:

<!-- -->

- Description - характеристики элемента;
- Run parameters - параметры запуска;
- Logs - логи исполняющей среды, сформированные во время исполнения данного элемента диаграммы;
- Rejects - список записей, которые не попали в таблицу при исполнении трансформации данных.

<!-- -->

- **Oozie log** - лог исполняющей среды Oozie, сформированный в процессе исполнения объекта;

- **Config** - код на языке Scala, описывающий объект.

  ### Обозреватель объектов

На странице **Обозреватель объектов** (рис. 23) отображается дерево объектов метаданных:

- **Project** - обозначается символом !(media/image45.png){width="0.28358267716535435in" height="0.2399540682414698in"};
- **Transformation** - обозначается символом !(media/image46.png){width="0.27611876640419947in" height="0.27611876640419947in"};
- **Workflow** - обозначается символом !(media/image47.png){width="0.2878455818022747in" height="0.26865594925634295in"}.

Список объектов позволяет быстро находить нужные объекты при помощи строки поиска, расположенной над списком, и переходить на страницы их редактирования, кликнув по объекту.

> !(media/image48.png){width="3.440298556430446in" height="4.3802384076990375in"}

Рисунок {#Рис_Обозреватель_Объектов .anchor}23. Обозреватель объектов

### Дизайнер диаграмм

Дизайнер диаграмм - один из графических интерфейсов программы Neoflex Datagram, который предназначен для построения диаграмм, описывающих логику работы объектов **Transformation** и **Workflow** (см. разделы «[Трансформация исходных данных](#трансформация-исходных-данных)» и «[Управление потоком работ](#управление-потоком-работ)»).

Чтобы перейти на страницу дизайнера диаграмм, нажмите кнопку «**Ссылки**», расположенную на панели навигации подсистемы **Meta Server** (рис. 18), и из списка выберите пункт:

- **Дизайнер процессов** - открывает страницу дизайнера диаграмм объектов **Workflow**;

<!-- -->

- **Дизайнер трансформаций** - открывает страницу дизайнера диаграмм объектов **Transformation**.

!(media/image49.png){width="6.061398731408574in" height="2.987425634295713in"}

Рисунок {#Рис_Дизайнер .anchor}24. Дизайнер Transformation

**Панель управления** (на рисунке 24 обозначена цифрой «1»). В левой части панели отображается текст, который был задан при создании объекта в поле **Label**. В правой части панели показана информация о пользователе, который выполнил вход в программу, и кнопка выхода из программы !(media/image50.png){width="0.39791666666666664in" height="0.31615266841644796in"}.

В центре панели расположены кнопки:

!(media/image51.png){width="0.4661231408573928in" height="0.417341426071741in"} (Edit properties) - редактирование атрибутов объекта Transformation или Workflow;

!(media/image52.png){width="0.46805555555555556in" height="0.4309076990376203in"} (Create new diagram) - создание нового объекта Transformation или Workflow;

!(media/image18.png){width="0.4625in" height="0.4126913823272091in"} (Save diagram) - сохранение диаграммы объекта;

!(media/image53.png){width="0.4618055555555556in" height="0.3772484689413823in"} (Load existing diagram) - загрузка диаграммы объекта;

!(media/image54.png){width="0.46319444444444446in" height="0.38935148731408575in"} (Copy) - копирование выбранного элемента;

!(media/image55.png){width="0.46041666666666664in" height="0.38701662292213473in"} (Paste) - вставка элемента из буфера;

!(media/image56.png){width="1.1045330271216098in" height="0.47454068241469816in"} (Undo/Redo) - кнопки позволяют отменить / применить отмененное действие;

!(media/image57.png){width="0.45555555555555555in" height="0.4193996062992126in"} (Clear all) - удаление всех элементов из рабочей области;

!(media/image58.png){width="1.0094335083114612in" height="0.42120297462817147in"} (Zoom in/Zoom out) - увеличение / уменьшение масштаба рабочей области;

!(media/image59.png){width="0.49375in" height="0.41503608923884516in"} (Scale to fit) - масштабирование диаграммы по размеру экрана;

!(media/image60.png){width="0.49583333333333335in" height="0.4424354768153981in"} (Layout left to right) - по кнопке выполняется выравнивание диаграммы и перенос в левый верхний угол рабочей области;

!(media/image61.png){width="0.4895833333333333in" height="0.43685804899387576in"} (View as JSON) - открывает форму просмотра диаграммы в формате json;

!(media/image19.png){width="0.4840277777777778in" height="0.43190069991251095in"} (Validate) - проверка корректности настроек объекта и логики его работы;

!(media/image62.png){width="0.4895833333333333in" height="0.4238178040244969in"} (Save to file) - сохранение диаграммы в формате .json;

!(media/image63.png){width="0.4791666666666667in" height="0.41480096237970254in"} (Load from) - загрузка диаграммы из файла формата .json;

!(media/image64.png){width="0.4861111111111111in" height="0.433759842519685in"} (Install transformation) - генерирует код, описывающий объект, выполняет компиляцию, создает объект TransformationDeployment или WorkflowDeployment (в зависимости от объекта, для которого выполняется операция) с названием «autogenerated» и для объектов Workflow копирует файлы на сервер Oozie;

!(media/image21.png){width="0.44375in" height="0.43622812773403324in"} (Run transformation) - запуск исполнения объекта Transformation или Workflow. Если перед запуском операции Run не была выполнена операция Install, то она будет выполнена автоматически;

!(media/image20.png){width="0.4791666666666667in" height="0.46205380577427824in"} (Open generated transformation code) - открывает страницу с кодом, описывающим трансформацию. Кнопка доступна только из интерфейса дизайнера диаграмм объектов Transformation;

**Панели элементов диаграммы** (на рисунке 24 обозначены цифрой «2»). Панели элементов диаграммы содержат элементы, которые могут быть использованы при создании диаграммы. В зависимости от настраиваемого объекта (Transformation или Workflow), названия панелей и их содержание будет различаться.

**Рабочая область дизайнера** (обозначена цифрой «3»). В рабочей области дизайнера выполняется построение диаграммы объекта.

**Панель свойств элемента** (обозначена цифрой «4»). Панель предназначена для настройки/редактирования свойств элементов, используемых в диаграмме. Панель свойств становится доступна при выделении объекта в рабочей области дизайнера.

**Область навигации** (обозначена цифрой «5»). Область навигации предназначена для быстрого перемещения по рабочей области.

**Панель инструментов** (обозначена цифрой «6») На панели инструментов расположены вкладки **Search**, **Lineage** (вкладка Lineage доступна только в дизайнере трансформаций) и **Errors**.

На вкладке **Search** находится строка поиска элементов схемы. Поиск элемента может быть выполнен по целому или части значения атрибутов **name** или **label**. Для найденного элемента будет представлена следующая информация:

- Значение поля name;
- Значения поля label;
- Тип элемента.

На вкладке **Lineage** можно просмотреть структуру потока данных, поступающего на входной порт элемента, отследить происхождение отдельных полей потока и проверить структуру потока данных на выходном порту элемента.

На вкладке **Errors** отображается список ошибок, возникших во время работы пользователя. Данный список очищается автоматически после обновления страницы.

**Пример работы с вкладкой Lineage**

В качестве примера рассмотрим элемент **Join5** в схеме трансформации, представленной на рисунке ниже.

!(media/image65.png){width="5.939855643044619in" height="2.0660378390201224in"}

Рисунок 25. Схема трансформации

Чтобы просмотреть структуру потока данных, поступающих на входные порты элемента **Join5**, откройте вкладку **Lineage** на панели инструментов и кликните по элементу в схеме.

!(media/image66.png){width="6.036960848643919in" height="4.05691491688539in"}

Рисунок {#Рис_Lineage .anchor}26. Структура входящего потока данных элемента Join5

Структура входящего потока данных будет представлена в виде таблицы на вкладке **In** (рис. 26).

Если кликнуть по строке таблицы с названием поля, то правее будет представлена схема происхождения данного поля.

!(media/image67.png){width="6.036960848643919in" height="2.4577077865266843in"}

Рисунок {#Рис_Происхождение_Поля .anchor}27. Схема происхождения поля seq\_id

Как видно из рисунка 27, поле **seq\_id**, поступающее на входной порт элемента **Join5,** происходит из поля **id**, передаваемого элементом **Sequence3**. В свою очередь, элемент трансформации **Sequence3** получает поле **id** из источника данных **Expression\_source1**.

Чтобы проверить структуру потока данных, передаваемого элементом трансформации, перейдите на вкладку **Out**.

!(media/image68.png){width="3.094339457567804in" height="2.8901454505686788in"}

Рисунок 28. Структура исходящего потока данных элемента Join5

<a id='code_editor'></a> 

#### Редактор кода трансформации

Редактор кода трансформации доступен только из интерфейса дизайнера диаграмм трансформации. В редакторе кода трансформации (рис. 29) можно просмотреть и, в случае необходимости, отредактировать код всей схемы трансформации, либо отдельной ее части.

!(media/image69.png){width="5.295651793525809in" height="2.6680380577427822in"}

Рисунок {#Рис_Редактор_кода_общ .anchor}29. Интерфейс редактора кода трансформаций

Для перехода на страницу редактора кода нажмите кнопку !(media/image20.png){width="0.3711417322834646in" height="0.35788713910761155in"} (Open generated transformation code), расположенную на панели управления дизайнера диаграмм объектов Transformation (рис. 24).

**Просмотр и редактирование кода схемы трансформации**

Код схемы трансформации - это код всей схемы трансформации на языке Scala, который генерируется программой и передается в исполняющую среду, при этом код не содержит параметров подключения к исполняющим средам и не может быть выполнен со страницы редактора.

Чтобы открыть код схемы трансформации, в списке **Transformation** (рис. 30) выберите название нужной схемы и нажмите кнопку **«Load code»**, код отобразится на вкладке, соответствующей названию выбранной трансформации.

!(media/image70.png){width="5.920988626421697in" height="3.8869564741907263in"}

Рисунок {#Рис_Редактор_кода .anchor}30. Код выбранной схемы трансформации

Редактирование кода выполняется по аналогии с любым текстовым редактором.

По завершении редактирования сохраните изменения нажатием кнопки **«Save»**.

**Просмотр и редактирование кода части схемы трансформации**

Код части схемы трансформации - это код на языке Scala от начала схемы трансформации до выбранного элемента включительно. Данный код содержит параметры подключения к исполняющей среде и может быть запущен на исполнение со страницы редактора.

Чтобы открыть код части схемы трансформации, в списке **Transformation** выберите название нужной схемы, в списке **Step** выберите элемент схемы, до которого включительно нужно получить код, и нажмите кнопку **«Load code»**. Код отобразится на вкладке, соответствующей названию выбранного элемента трансформации (рис. 31).

!(media/image71.png){width="5.799167760279965in" height="3.208695319335083in"}

Рисунок {#Рис_Код_части_схемы .anchor}31. Редактор кода трансформации

На странице редактора кода при помощи списка **Select server** назначается сервер, на котором установлена исполняющая среда. В зависимости от выбранного сервера, отображаемый код может отличаться.

Запуск исполнения кода происходит по кнопке **«Run»**.