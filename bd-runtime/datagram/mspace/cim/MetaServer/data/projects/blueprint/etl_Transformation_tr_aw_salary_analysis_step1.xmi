<?xml version="1.0" encoding="ASCII"?>
<etl:Transformation xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:etl="http://www.neoflex.ru/meta/etl" name="tr_aw_salary_analysis_step1" label="tr_aw_salary_analysis_step1" sparkVersion="SPARK3" description="&#x417;&#x430;&#x434;&#x430;&#x447;&#x430;: &#x41f;&#x440;&#x43e;&#x432;&#x435;&#x441;&#x442;&#x438; &#x438;&#x43d;&#x434;&#x435;&#x43a;&#x441;&#x430;&#x446;&#x438;&#x44e; &#x437;&#x430;&#x440;&#x43f;&#x43b;&#x430;&#x442; &#x441; &#x443;&#x447;&#x435;&#x442;&#x43e;&#x43c; &#x431;&#x438;&#x437;&#x43d;&#x435;&#x441; &#x43f;&#x440;&#x430;&#x432;&#x438;&#x43b;.&#xA;&#x412;&#x440;&#x435;&#x43c;&#x44f; &#x43f;&#x440;&#x43e;&#x432;&#x435;&#x434;&#x435;&#x43d;&#x438;&#x44f;: &#x434;&#x435;&#x43a;&#x430;&#x431;&#x440;&#x44c; 2013 &#x433;&#x43e;&#x434;&#x430;&#xA;&#xA;&#x41f;&#x440;&#x430;&#x432;&#x438;&#x43b;&#x430; &#x431;&#x438;&#x437;&#x43d;&#x435;&#x441;&#x430;:&#xA;1. &#x41f;&#x43e;&#x432;&#x44b;&#x448;&#x430;&#x442;&#x44c; &#x417;&#x41f; &#x43c;&#x430;&#x43a;&#x441;&#x438;&#x43c;&#x443;&#x43c; 2 &#x440;&#x430;&#x437;&#x430; &#x432; &#x433;&#x43e;&#x434;&#xA;2. &#x41c;&#x430;&#x43a;&#x441;&#x438;&#x43c;&#x430;&#x43b;&#x44c;&#x43d;&#x43e;&#x435; &#x43f;&#x43e;&#x432;&#x44b;&#x448;&#x435;&#x43d;&#x438;&#x435; &#x417;&#x41f; 30% &#x432; &#x433;&#x43e;&#x434;&#xA;3. &#x412; &#x441;&#x43b;&#x443;&#x447;&#x430;&#x435; &#x43d;&#x435;&#x441;&#x43e;&#x431;&#x43b;&#x44e;&#x434;&#x435;&#x43d;&#x438;&#x44f; &#x43f;&#x440;&#x430;&#x432;&#x438;&#x43b; 1 &#x438;&#x43b;&#x438; 2, &#x43d;&#x435;&#x43e;&#x431;&#x445;&#x43e;&#x434;&#x438;&#x43c;&#x43e; &#x441;&#x43e;&#x433;&#x43b;&#x430;&#x441;&#x43e;&#x432;&#x430;&#x43d;&#x438;&#x435; &#x440;&#x443;&#x43a;&#x43e;&#x432;&#x43e;&#x434;&#x438;&#x442;&#x435;&#x43b;&#x44f; &#x43a;&#x43e;&#x43c;&#x43f;&#x430;&#x43d;&#x438;&#x438;.&#xA;&#xA;&#x412; Step 1: &#x424;&#x43e;&#x440;&#x43c;&#x438;&#x440;&#x43e;&#x432;&#x430;&#x43d;&#x438;&#x435; &#x434;&#x432;&#x443;&#x445; &#x442;&#x430;&#x431;&#x43b;&#x438;&#x446;:&#xA;1. &#x41f;&#x43e;&#x441;&#x43b;&#x435;&#x434;&#x43d;&#x435;&#x435; &#x43f;&#x43e;&#x432;&#x44b;&#x448;&#x435;&#x43d;&#x438;&#x435; &#x417;&#x41f; &#x441;&#x43e;&#x442;&#x440;&#x443;&#x434;&#x43d;&#x438;&#x43a;&#x443;&#xA;2. &#x41f;&#x440;&#x435;&#x434;&#x43f;&#x43e;&#x441;&#x43b;&#x435;&#x434;&#x43d;&#x435;&#x435; &#x43f;&#x43e;&#x432;&#x44b;&#x448;&#x435;&#x43d;&#x438;&#x435; &#x417;&#x41f; &#x441;&#x43e;&#x442;&#x440;&#x443;&#x434;&#x43d;&#x438;&#x43a;&#x443;" jsonView="{&quot;cells&quot;:[{&quot;type&quot;:&quot;devs.transformation.SqlSource&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:34.375,&quot;y&quot;:20},&quot;angle&quot;:0,&quot;id&quot;:&quot;440b2769-a272-4715-b4b1-3cd6afc5b7cf&quot;,&quot;name&quot;:&quot;EmployeePayHistory_1&quot;,&quot;z&quot;:1,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;EmployeePayHistory_1&quot;}}},{&quot;type&quot;:&quot;devs.transformation.SqlSource&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:30,&quot;y&quot;:150},&quot;angle&quot;:0,&quot;id&quot;:&quot;8c53ebb9-6a73-4d7c-b07c-078d4312544a&quot;,&quot;name&quot;:&quot;EmployeePayHistory_1_2&quot;,&quot;z&quot;:2,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;EmployeePayHistory_1_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.SqlSource&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:30,&quot;y&quot;:270},&quot;angle&quot;:0,&quot;id&quot;:&quot;6e47628a-6a61-4ea8-8c96-2262d0169220&quot;,&quot;name&quot;:&quot;EmployeePayHistory_2&quot;,&quot;z&quot;:3,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;EmployeePayHistory_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.SqlSource&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:30,&quot;y&quot;:450},&quot;angle&quot;:0,&quot;id&quot;:&quot;8bb12dbd-7652-406b-9a04-9e1dc92763e0&quot;,&quot;name&quot;:&quot;EmployeePayHistory_2_2&quot;,&quot;z&quot;:4,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;EmployeePayHistory_2_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Aggregation&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:180,&quot;y&quot;:30},&quot;angle&quot;:0,&quot;id&quot;:&quot;429055fa-6d80-464e-820e-e8599cba4f6c&quot;,&quot;name&quot;:&quot;Aggregation_1&quot;,&quot;z&quot;:5,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Aggregation_1&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Join&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;,&quot;join&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;join&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;join&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:334.375,&quot;y&quot;:50},&quot;angle&quot;:0,&quot;id&quot;:&quot;f383edc7-eae3-48c5-8cc0-8eaea93f8733&quot;,&quot;name&quot;:&quot;Join_1&quot;,&quot;z&quot;:6,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Join_1&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Projection&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:484.375,&quot;y&quot;:50},&quot;angle&quot;:0,&quot;id&quot;:&quot;3283e8e6-bfc3-43c8-94cf-cec1df2cf7e4&quot;,&quot;name&quot;:&quot;Projection_1&quot;,&quot;z&quot;:7,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Projection_1&quot;}}},{&quot;type&quot;:&quot;devs.transformation.SparkSQL&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;sqlin&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}},{&quot;id&quot;:&quot;0&quot;,&quot;multiple&quot;:true,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;sparkTable&quot;,&quot;visibility&quot;:&quot;visible&quot;},&quot;circle&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}]},&quot;position&quot;:{&quot;x&quot;:210,&quot;y&quot;:300},&quot;angle&quot;:0,&quot;id&quot;:&quot;36f8c562-e5bc-4d1f-ba63-ec88000ed0a4&quot;,&quot;name&quot;:&quot;Spark_SQL_2&quot;,&quot;z&quot;:8,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Spark_SQL_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Join&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;,&quot;join&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;join&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;join&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:630,&quot;y&quot;:390},&quot;angle&quot;:0,&quot;id&quot;:&quot;743235b3-9437-49c9-87f8-3702a975af45&quot;,&quot;name&quot;:&quot;Join_2&quot;,&quot;z&quot;:9,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Join_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Projection&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:750,&quot;y&quot;:390},&quot;angle&quot;:0,&quot;id&quot;:&quot;f0d74ddf-0963-4c53-9b09-4acd6912c6d2&quot;,&quot;name&quot;:&quot;Projection_2_2&quot;,&quot;z&quot;:10,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Projection_2_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Selection&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:420,&quot;y&quot;:300},&quot;angle&quot;:0,&quot;id&quot;:&quot;50c85d6b-b046-427c-b5e3-c50f4f5e2020&quot;,&quot;name&quot;:&quot;Selection_2&quot;,&quot;z&quot;:11,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Selection_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.LocalTarget&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:660,&quot;y&quot;:60},&quot;angle&quot;:0,&quot;id&quot;:&quot;36773e91-dc6c-42f1-8d5f-95ca0fabbeb0&quot;,&quot;name&quot;:&quot;in_HDFS_1&quot;,&quot;z&quot;:12,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;in_HDFS_1&quot;}}},{&quot;type&quot;:&quot;devs.transformation.LocalTarget&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:870,&quot;y&quot;:390},&quot;angle&quot;:0,&quot;id&quot;:&quot;bb7a4cbf-6cbb-4077-bfb2-494ed44d7e35&quot;,&quot;name&quot;:&quot;in_HDFS_2&quot;,&quot;z&quot;:13,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;in_HDFS_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;6e47628a-6a61-4ea8-8c96-2262d0169220&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;36f8c562-e5bc-4d1f-ba63-ec88000ed0a4&quot;,&quot;port&quot;:&quot;0&quot;},&quot;id&quot;:&quot;b801eced-ad61-4250-a31f-bbed7023bcdf&quot;,&quot;z&quot;:14,&quot;attrs&quot;:{}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;440b2769-a272-4715-b4b1-3cd6afc5b7cf&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;429055fa-6d80-464e-820e-e8599cba4f6c&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;5b37bcb3-a5e0-4ad6-8ea0-93a8782e6e0d&quot;,&quot;z&quot;:15,&quot;attrs&quot;:{}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;429055fa-6d80-464e-820e-e8599cba4f6c&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;f383edc7-eae3-48c5-8cc0-8eaea93f8733&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;69cf5485-5021-421d-b831-ea39f814c2cf&quot;,&quot;z&quot;:16,&quot;attrs&quot;:{}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;8c53ebb9-6a73-4d7c-b07c-078d4312544a&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;f383edc7-eae3-48c5-8cc0-8eaea93f8733&quot;,&quot;port&quot;:&quot;join&quot;},&quot;id&quot;:&quot;bae1c864-be9a-427b-b116-7dab76f7468e&quot;,&quot;z&quot;:17,&quot;attrs&quot;:{}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;f383edc7-eae3-48c5-8cc0-8eaea93f8733&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;3283e8e6-bfc3-43c8-94cf-cec1df2cf7e4&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;b0a35b57-6a50-4256-bc3f-4e1ded1998ef&quot;,&quot;z&quot;:18,&quot;attrs&quot;:{}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;743235b3-9437-49c9-87f8-3702a975af45&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;f0d74ddf-0963-4c53-9b09-4acd6912c6d2&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;74f6b762-ea9d-4085-836c-8380982fc661&quot;,&quot;z&quot;:19,&quot;attrs&quot;:{}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;3283e8e6-bfc3-43c8-94cf-cec1df2cf7e4&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;36773e91-dc6c-42f1-8d5f-95ca0fabbeb0&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;d5951481-773e-43b8-804f-9f617efe9629&quot;,&quot;z&quot;:20,&quot;attrs&quot;:{}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;f0d74ddf-0963-4c53-9b09-4acd6912c6d2&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;bb7a4cbf-6cbb-4077-bfb2-494ed44d7e35&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;ef7bdaa6-ef42-47f1-9abf-de565af0e43a&quot;,&quot;z&quot;:21,&quot;attrs&quot;:{}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;36f8c562-e5bc-4d1f-ba63-ec88000ed0a4&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;50c85d6b-b046-427c-b5e3-c50f4f5e2020&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;9d8a98ef-804e-4411-82d6-cb08db943c24&quot;,&quot;z&quot;:22,&quot;attrs&quot;:{}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;50c85d6b-b046-427c-b5e3-c50f4f5e2020&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;743235b3-9437-49c9-87f8-3702a975af45&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;af2d68f9-9a83-468d-a97c-89a8d79c8e43&quot;,&quot;z&quot;:23,&quot;attrs&quot;:{}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;8bb12dbd-7652-406b-9a04-9e1dc92763e0&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;743235b3-9437-49c9-87f8-3702a975af45&quot;,&quot;port&quot;:&quot;join&quot;},&quot;id&quot;:&quot;5834aeec-8f9d-4ce6-ab67-46d20b918bc3&quot;,&quot;z&quot;:24,&quot;attrs&quot;:{}}]}">
  <targets xsi:type="etl:LocalTarget" name="in_HDFS_1" label="in_HDFS_1" localFileName="/tmp/salary/table1" localFileFormat="ORC" saveMode="OVERWRITE" registerTable="true" hiveTableName="salary_analysis">
    <inputPort name="Local_24in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="date_last" dataTypeDomain="DATETIME"/>
      <fields name="rate_last" dataTypeDomain="DECIMAL"/>
    </inputPort>
  </targets>
  <targets xsi:type="etl:LocalTarget" name="in_HDFS_2" label="in_HDFS_2" localFileName="/tmp/salary/table2" localFileFormat="ORC" saveMode="OVERWRITE" registerTable="true" hiveTableName="salary_analysis_2">
    <inputPort name="Local_24in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="date_previous" dataTypeDomain="DATETIME"/>
      <fields name="rate_previous" dataTypeDomain="DECIMAL"/>
    </inputPort>
  </targets>
  <transformationSteps xsi:type="etl:Aggregation" name="Aggregation_1" label="Aggregation_1">
    <outputPort name="Aggregation_5out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber" dataTypeDomain="LONG"/>
    </outputPort>
    <inputPort name="Aggregation_5in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber" dataTypeDomain="LONG"/>
    </inputPort>
    <groupByFieldName>businessentityid</groupByFieldName>
    <aggregationParameters resultFieldName="payratenumber" fieldName="payratenumber" aggregationFunction="MIN"/>
  </transformationSteps>
  <transformationSteps xsi:type="etl:Join" name="Join_1" label="Join_1" joinType="LEFT">
    <outputPort name="Join_4out">
      <fields xsi:type="etl:ProjectionField" name="businessentityid" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.1/@inputPort/@fields.0"/>
      <fields xsi:type="etl:ProjectionField" name="payratenumber" dataTypeDomain="LONG" sourceFields="//@transformationSteps.1/@inputPort/@fields.1"/>
      <fields xsi:type="etl:ProjectionField" name="businessentityid_2" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.1/@joineePort/@fields.0"/>
      <fields xsi:type="etl:ProjectionField" name="payratenumber_2" dataTypeDomain="LONG" sourceFields="//@transformationSteps.1/@joineePort/@fields.1"/>
      <fields xsi:type="etl:ProjectionField" name="date_2" dataTypeDomain="DATETIME" sourceFields="//@transformationSteps.1/@joineePort/@fields.2"/>
      <fields xsi:type="etl:ProjectionField" name="rate_2" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.1/@joineePort/@fields.3"/>
    </outputPort>
    <inputPort name="Join_4in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber" dataTypeDomain="LONG"/>
    </inputPort>
    <joineePort name="Join_4join">
      <fields name="businessentityid_2" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber_2" dataTypeDomain="LONG"/>
      <fields name="date_2" dataTypeDomain="DATETIME"/>
      <fields name="rate_2" dataTypeDomain="DECIMAL"/>
    </joineePort>
    <keyFields>businessentityid</keyFields>
    <keyFields>payratenumber</keyFields>
    <joineeKeyFields>businessentityid_2</joineeKeyFields>
    <joineeKeyFields>payratenumber_2</joineeKeyFields>
  </transformationSteps>
  <transformationSteps xsi:type="etl:Projection" name="Projection_1" label="Projection_1">
    <outputPort name="Projection_16out">
      <fields xsi:type="etl:ProjectionField" name="businessentityid" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.2/@inputPort/@fields.0"/>
      <fields xsi:type="etl:ProjectionField" name="date_last" dataTypeDomain="DATETIME" sourceFields="//@transformationSteps.2/@inputPort/@fields.4" expression="&quot;&quot;"/>
      <fields xsi:type="etl:ProjectionField" name="rate_last" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.2/@inputPort/@fields.5" expression=""/>
    </outputPort>
    <inputPort name="Projection_16in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber" dataTypeDomain="LONG"/>
      <fields name="businessentityid_2" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber_2" dataTypeDomain="LONG"/>
      <fields name="date_2" dataTypeDomain="DATETIME"/>
      <fields name="rate_2" dataTypeDomain="DECIMAL"/>
    </inputPort>
  </transformationSteps>
  <transformationSteps xsi:type="etl:SparkSQL" name="Spark_SQL_2" label="Spark_SQL_2" statement="select &#xA;    businessentityid,&#xA;    row_number() OVER (&#xA;        PARTITION BY businessentityid ORDER BY ratechangedate DESC&#xA;    ) payRateNumber&#xA;from sparkTable">
    <outputPort name="Spark_SQL_11out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payRateNumber" dataTypeDomain="LONG"/>
    </outputPort>
    <sqlPorts name="sparkTable" alias="sparkTable">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="ratechangedate" dataTypeDomain="DATETIME"/>
    </sqlPorts>
  </transformationSteps>
  <transformationSteps xsi:type="etl:Join" name="Join_2" label="Join_2" joinType="LEFT">
    <outputPort name="Join_4out">
      <fields xsi:type="etl:ProjectionField" name="businessentityid" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.4/@inputPort/@fields.0"/>
      <fields xsi:type="etl:ProjectionField" name="payRateNumber" dataTypeDomain="LONG" sourceFields="//@transformationSteps.4/@inputPort/@fields.1"/>
      <fields xsi:type="etl:ProjectionField" name="businessentityid_2" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.4/@joineePort/@fields.0"/>
      <fields xsi:type="etl:ProjectionField" name="payratenumber_2" dataTypeDomain="LONG" sourceFields="//@transformationSteps.4/@joineePort/@fields.1"/>
      <fields xsi:type="etl:ProjectionField" name="date_2" dataTypeDomain="DATETIME" sourceFields="//@transformationSteps.4/@joineePort/@fields.2"/>
      <fields xsi:type="etl:ProjectionField" name="rate_2" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.4/@joineePort/@fields.3"/>
    </outputPort>
    <inputPort name="Join_4in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payRateNumber" dataTypeDomain="LONG"/>
    </inputPort>
    <joineePort name="Join_4join">
      <fields name="businessentityid_2" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber_2" dataTypeDomain="LONG"/>
      <fields name="date_2" dataTypeDomain="DATETIME"/>
      <fields name="rate_2" dataTypeDomain="DECIMAL"/>
    </joineePort>
    <keyFields>businessentityid</keyFields>
    <keyFields>payRateNumber</keyFields>
    <joineeKeyFields>businessentityid_2</joineeKeyFields>
    <joineeKeyFields>payratenumber_2</joineeKeyFields>
  </transformationSteps>
  <transformationSteps xsi:type="etl:Projection" name="Projection_2_2" label="Projection_2_2">
    <outputPort name="Projection_16out">
      <fields xsi:type="etl:ProjectionField" name="businessentityid" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.5/@inputPort/@fields.0"/>
      <fields xsi:type="etl:ProjectionField" name="date_previous" dataTypeDomain="DATETIME" sourceFields="//@transformationSteps.5/@inputPort/@fields.4"/>
      <fields xsi:type="etl:ProjectionField" name="rate_previous" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.5/@inputPort/@fields.5"/>
    </outputPort>
    <inputPort name="Projection_16in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payRateNumber" dataTypeDomain="LONG"/>
      <fields name="businessentityid_2" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber_2" dataTypeDomain="LONG"/>
      <fields name="date_2" dataTypeDomain="DATETIME"/>
      <fields name="rate_2" dataTypeDomain="DECIMAL"/>
    </inputPort>
  </transformationSteps>
  <transformationSteps xsi:type="etl:Selection" name="Selection_2" label="Selection_2" expression="payRateNumber = 2">
    <outputPort name="Selection_26out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payRateNumber" dataTypeDomain="LONG"/>
    </outputPort>
    <inputPort name="Selection_26in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payRateNumber" dataTypeDomain="LONG"/>
    </inputPort>
  </transformationSteps>
  <sources xsi:type="etl:SQLSource" name="EmployeePayHistory_1" label="EmployeePayHistory_1" statement="select&#xA;&#x9;businessentityid,&#xA;&#x9;ROW_NUMBER() OVER(PARTITION BY businessentityid ORDER BY ratechangedate DESC) as &#xA;        payRateNumber&#xA;from humanresources.employeepayhistory">
    <outputPort name="SQL_0out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber" dataTypeDomain="LONG"/>
    </outputPort>
  </sources>
  <sources xsi:type="etl:SQLSource" name="EmployeePayHistory_1_2" label="EmployeePayHistory_1_2" statement="select&#xA;&#x9;businessentityid as businessentityid_2,&#xA;&#x9;ROW_NUMBER() OVER(PARTITION BY businessentityid ORDER BY ratechangedate DESC) as &#xA;        payRateNumber_2,&#xA;&#x9;ratechangedate as date_2,&#xA;        rate as rate_2&#xA;from humanresources.employeepayhistory">
    <outputPort name="SQL_0out">
      <fields name="businessentityid_2" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber_2" dataTypeDomain="LONG"/>
      <fields name="date_2" dataTypeDomain="DATETIME"/>
      <fields name="rate_2" dataTypeDomain="DECIMAL"/>
    </outputPort>
  </sources>
  <sources xsi:type="etl:SQLSource" name="EmployeePayHistory_2" label="EmployeePayHistory_2" statement="select&#xA;&#x9;businessentityid,&#xA;        ratechangedate&#xA;from humanresources.employeepayhistory">
    <outputPort name="SQL_0out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="ratechangedate" dataTypeDomain="DATETIME"/>
    </outputPort>
  </sources>
  <sources xsi:type="etl:SQLSource" name="EmployeePayHistory_2_2" label="EmployeePayHistory_2_2" statement="select&#xA;&#x9;businessentityid as businessentityid_2,&#xA;&#x9;ROW_NUMBER() OVER(PARTITION BY businessentityid ORDER BY ratechangedate DESC) as &#xA;        payRateNumber_2,&#xA;&#x9;ratechangedate as date_2,&#xA;        rate as rate_2&#xA;from humanresources.employeepayhistory">
    <outputPort name="SQL_0out">
      <fields name="businessentityid_2" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber_2" dataTypeDomain="LONG"/>
      <fields name="date_2" dataTypeDomain="DATETIME"/>
      <fields name="rate_2" dataTypeDomain="DECIMAL"/>
    </outputPort>
  </sources>
  <transitions name="30bc5bdd-8fef-44d2-8bf8-e7e618bc9f2e" start="//@sources.2/@outputPort" finish="//@transformationSteps.3/@sqlPorts.0"/>
  <transitions name="39f649b1-19a4-45b4-a9fd-1dac85c733cf" start="//@sources.0/@outputPort" finish="//@transformationSteps.0/@inputPort"/>
  <transitions name="22315777-5753-4629-9854-3ab08118abf3" start="//@transformationSteps.0/@outputPort" finish="//@transformationSteps.1/@inputPort"/>
  <transitions name="d8206459-7e3b-4bab-806e-68d7f9076ebb" start="//@sources.1/@outputPort" finish="//@transformationSteps.1/@joineePort"/>
  <transitions name="1a907620-77cd-4cb0-9b1d-d872a0a0d31c" start="//@transformationSteps.1/@outputPort" finish="//@transformationSteps.2/@inputPort"/>
  <transitions name="94a1624a-db30-4e3d-989a-e35d0eda4dcb" start="//@transformationSteps.4/@outputPort" finish="//@transformationSteps.5/@inputPort"/>
  <transitions name="1be2204c-8eb7-40e1-880f-cb3f4fd6644a" start="//@transformationSteps.2/@outputPort" finish="//@targets.0/@inputPort"/>
  <transitions name="94d67aaf-e90e-4b60-92f2-da3b795d371a" start="//@transformationSteps.5/@outputPort" finish="//@targets.1/@inputPort"/>
  <transitions name="80446933-5646-4bb8-8775-e2d91d4db268" start="//@transformationSteps.3/@outputPort" finish="//@transformationSteps.6/@inputPort"/>
  <transitions name="619fe6bd-e0bc-4911-a320-49e5eab51a09" start="//@transformationSteps.6/@outputPort" finish="//@transformationSteps.4/@inputPort"/>
  <transitions name="8e533829-30e0-4d1f-a55e-74d040ed9a37" start="//@sources.3/@outputPort" finish="//@transformationSteps.4/@joineePort"/>
  <auditInfo changeUser="admin" changeDateTime="2021-03-23T09:00:14.366+0000" createUser="admin" createDateTime="2021-03-15T14:09:34.608+0000"/>
</etl:Transformation>
