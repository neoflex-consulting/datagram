<?xml version="1.0" encoding="ASCII"?>
<etl:Transformation xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:etl="http://www.neoflex.ru/meta/etl" name="tr_adventureWorks" label="tr_adventureWorks" sparkVersion="SPARK3" description="EmployeePayHistory - id &#x441;&#x43e;&#x442;&#x440;&#x443;&#x434;&#x43d;&#x438;&#x43a;&#x430;, &#x43a;&#x430;&#x43a;&#x43e;&#x439; &#x440;&#x430;&#x437; &#x435;&#x43c;&#x443; &#x43f;&#x43e;&#x434;&#x43d;&#x438;&#x43c;&#x430;&#x44e;&#x442; &#x417;&#x41f;, &#x434;&#x430;&#x442;&#x430; &#x443;&#x432;&#x435;&#x43b;&#x438;&#x447;&#x435;&#x43d;&#x438;&#x44f;, &#x441;&#x442;&#x43e;&#x438;&#x43c;&#x43e;&#x441;&#x442;&#x44c;." jsonView="{&quot;cells&quot;:[{&quot;type&quot;:&quot;devs.transformation.SqlSource&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:34.375,&quot;y&quot;:20},&quot;angle&quot;:0,&quot;id&quot;:&quot;5ebdb7b5-45e8-4e0b-a9cb-26c3ebf7117a&quot;,&quot;name&quot;:&quot;EmployeePayHistory_1&quot;,&quot;z&quot;:1,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;EmployeePayHistory_1&quot;}}},{&quot;type&quot;:&quot;devs.transformation.SqlSource&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:34.375,&quot;y&quot;:140},&quot;angle&quot;:0,&quot;id&quot;:&quot;a281e314-dffc-44ad-b744-79ef6bce517d&quot;,&quot;name&quot;:&quot;EmployeePayHistory_1_2&quot;,&quot;z&quot;:2,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;EmployeePayHistory_1_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.SqlSource&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:34.375,&quot;y&quot;:290},&quot;angle&quot;:0,&quot;id&quot;:&quot;af4932cc-fc0f-416f-9d36-059c4fdc416e&quot;,&quot;name&quot;:&quot;EmployeePayHistory_2&quot;,&quot;z&quot;:3,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;EmployeePayHistory_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.SqlSource&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:30,&quot;y&quot;:450},&quot;angle&quot;:0,&quot;id&quot;:&quot;d825a788-c9c8-477e-bae6-0f16cea0e2e0&quot;,&quot;name&quot;:&quot;EmployeePayHistory_2_2&quot;,&quot;z&quot;:4,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;EmployeePayHistory_2_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Aggregation&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:154.375,&quot;y&quot;:20},&quot;angle&quot;:0,&quot;id&quot;:&quot;01981825-629a-4a0f-8bba-839d1dc5b3ef&quot;,&quot;name&quot;:&quot;Aggregation_1&quot;,&quot;z&quot;:5,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Aggregation_1&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Join&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;,&quot;join&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;join&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;join&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:334.375,&quot;y&quot;:50},&quot;angle&quot;:0,&quot;id&quot;:&quot;abac4752-9896-4a0a-9e48-c55086ef7f3e&quot;,&quot;name&quot;:&quot;Join_1&quot;,&quot;z&quot;:6,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Join_1&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Projection&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:484.375,&quot;y&quot;:50},&quot;angle&quot;:0,&quot;id&quot;:&quot;74e5fb7e-4824-4ea5-8a4c-ebd15582b7a0&quot;,&quot;name&quot;:&quot;Projection_1&quot;,&quot;z&quot;:7,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Projection_1&quot;}}},{&quot;type&quot;:&quot;devs.transformation.SparkSQL&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;sqlin&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}},{&quot;id&quot;:&quot;0&quot;,&quot;multiple&quot;:true,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;sparkTable&quot;,&quot;visibility&quot;:&quot;visible&quot;},&quot;circle&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}]},&quot;position&quot;:{&quot;x&quot;:210,&quot;y&quot;:300},&quot;angle&quot;:0,&quot;id&quot;:&quot;7a5538ea-214c-45ca-b84f-e1efed703365&quot;,&quot;name&quot;:&quot;Spark_SQL_2&quot;,&quot;z&quot;:8,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Spark_SQL_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Projection&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:372,&quot;y&quot;:296},&quot;angle&quot;:0,&quot;id&quot;:&quot;2435a283-1df1-4028-9b56-b56d01721fe1&quot;,&quot;name&quot;:&quot;Projection_2&quot;,&quot;z&quot;:9,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Projection_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Selection&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:524,&quot;y&quot;:292},&quot;angle&quot;:0,&quot;id&quot;:&quot;69e2152b-2e14-4d7e-804b-c3d7ad49ffd3&quot;,&quot;name&quot;:&quot;Selection_2&quot;,&quot;z&quot;:10,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Selection_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Aggregation&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:660,&quot;y&quot;:300},&quot;angle&quot;:0,&quot;id&quot;:&quot;1b2e60f5-6b66-4089-8bef-17a4fe5c291b&quot;,&quot;name&quot;:&quot;Aggregation_2&quot;,&quot;z&quot;:11,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Aggregation_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Join&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;,&quot;join&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;join&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;join&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:780,&quot;y&quot;:390},&quot;angle&quot;:0,&quot;id&quot;:&quot;b66f40e3-c158-47a9-8ba0-84748225df00&quot;,&quot;name&quot;:&quot;Join_2&quot;,&quot;z&quot;:12,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Join_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Projection&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:930,&quot;y&quot;:390},&quot;angle&quot;:0,&quot;id&quot;:&quot;835c98a9-79ac-4760-bfb7-b14809d0c2b1&quot;,&quot;name&quot;:&quot;Projection_2_2&quot;,&quot;z&quot;:13,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Projection_2_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.CSVTarget&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:634.375,&quot;y&quot;:50},&quot;angle&quot;:0,&quot;id&quot;:&quot;2a08d6af-1c9d-455f-ae92-f37abb80242d&quot;,&quot;name&quot;:&quot;CSV_1&quot;,&quot;z&quot;:14,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;CSV_1&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;abac4752-9896-4a0a-9e48-c55086ef7f3e&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;74e5fb7e-4824-4ea5-8a4c-ebd15582b7a0&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;4728a6fe-2f6d-4cdc-8790-2b9b969ddbb2&quot;,&quot;z&quot;:15,&quot;name&quot;:&quot;8aec49dd-6a20-4f7b-aac6-2b8f45712698&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;8aec49dd-6a20-4f7b-aac6-2b8f45712698&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;01981825-629a-4a0f-8bba-839d1dc5b3ef&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;abac4752-9896-4a0a-9e48-c55086ef7f3e&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;3f3d908d-219c-4fc5-9532-9c426163ca37&quot;,&quot;z&quot;:16,&quot;name&quot;:&quot;42f3f99d-522a-4e4c-bcea-fa4f20fd8bc9&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;42f3f99d-522a-4e4c-bcea-fa4f20fd8bc9&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;a281e314-dffc-44ad-b744-79ef6bce517d&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;abac4752-9896-4a0a-9e48-c55086ef7f3e&quot;,&quot;port&quot;:&quot;join&quot;},&quot;id&quot;:&quot;397ae459-d6c7-40c7-aaa0-6e14a4a2edc1&quot;,&quot;z&quot;:17,&quot;name&quot;:&quot;7f104682-ae6d-4942-a8aa-e804298cc8a4&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;7f104682-ae6d-4942-a8aa-e804298cc8a4&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;74e5fb7e-4824-4ea5-8a4c-ebd15582b7a0&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;2a08d6af-1c9d-455f-ae92-f37abb80242d&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;c21d6190-56d7-4ecd-b1fb-389ec0b3d197&quot;,&quot;z&quot;:18,&quot;name&quot;:&quot;db276891-4d37-4c1a-917a-23c6ac249afe&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;db276891-4d37-4c1a-917a-23c6ac249afe&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;5ebdb7b5-45e8-4e0b-a9cb-26c3ebf7117a&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;01981825-629a-4a0f-8bba-839d1dc5b3ef&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;bb19d331-036e-452b-8232-c3dd7028a5b9&quot;,&quot;z&quot;:19,&quot;name&quot;:&quot;dfb22fd6-46af-48d0-af17-eca172894fc3&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;dfb22fd6-46af-48d0-af17-eca172894fc3&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;af4932cc-fc0f-416f-9d36-059c4fdc416e&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;7a5538ea-214c-45ca-b84f-e1efed703365&quot;,&quot;port&quot;:&quot;0&quot;},&quot;id&quot;:&quot;c8c7fbd9-af0f-4708-9138-71300eb17995&quot;,&quot;z&quot;:20,&quot;name&quot;:&quot;3f75ddff-3c62-4207-a9be-395c6b717863&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;3f75ddff-3c62-4207-a9be-395c6b717863&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;7a5538ea-214c-45ca-b84f-e1efed703365&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;2435a283-1df1-4028-9b56-b56d01721fe1&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;f1b4e5f6-4dfb-42d2-83b0-b42c533f668e&quot;,&quot;z&quot;:21,&quot;name&quot;:&quot;ff4cf5b9-7ae2-4a84-835d-472dff5e1ce9&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;ff4cf5b9-7ae2-4a84-835d-472dff5e1ce9&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;2435a283-1df1-4028-9b56-b56d01721fe1&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;69e2152b-2e14-4d7e-804b-c3d7ad49ffd3&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;22147770-977e-4825-a6f4-8414c0365b6e&quot;,&quot;z&quot;:22,&quot;name&quot;:&quot;347c093a-56e2-4b39-9818-0d501701879a&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;347c093a-56e2-4b39-9818-0d501701879a&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;69e2152b-2e14-4d7e-804b-c3d7ad49ffd3&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;1b2e60f5-6b66-4089-8bef-17a4fe5c291b&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;319f8b99-fcff-4dec-aafc-e1f134fa20d8&quot;,&quot;z&quot;:23,&quot;name&quot;:&quot;8359d2b4-ec50-4705-b602-903b31d19885&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;8359d2b4-ec50-4705-b602-903b31d19885&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;1b2e60f5-6b66-4089-8bef-17a4fe5c291b&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;b66f40e3-c158-47a9-8ba0-84748225df00&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;eec6de8b-5f04-43b5-b6f0-65ff414c826d&quot;,&quot;z&quot;:24,&quot;name&quot;:&quot;5cf40eca-df07-4349-8169-8274376b095b&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;5cf40eca-df07-4349-8169-8274376b095b&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;d825a788-c9c8-477e-bae6-0f16cea0e2e0&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;b66f40e3-c158-47a9-8ba0-84748225df00&quot;,&quot;port&quot;:&quot;join&quot;},&quot;id&quot;:&quot;429964e3-cfd8-45c8-86d1-bb7d25fb1799&quot;,&quot;z&quot;:25,&quot;name&quot;:&quot;ca0dcbb3-f574-40c2-ae40-c0a1ba820f2a&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;ca0dcbb3-f574-40c2-ae40-c0a1ba820f2a&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;b66f40e3-c158-47a9-8ba0-84748225df00&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;835c98a9-79ac-4760-bfb7-b14809d0c2b1&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;c0300a53-ede8-4029-8c7f-00a251e5e07a&quot;,&quot;z&quot;:26,&quot;name&quot;:&quot;42ccbb78-d098-4ae9-aef4-9c6a64f9e4a2&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;42ccbb78-d098-4ae9-aef4-9c6a64f9e4a2&quot;}}}]}">
  <targets xsi:type="etl:CSVTarget" name="CSV_1" label="CSV_1" csvFormat="EXCEL" path="/tmp/test.xls" quote="&quot;" escape="\">
    <inputPort name="CSV_18in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="date" dataTypeDomain="DATETIME"/>
      <fields name="rate" dataTypeDomain="DECIMAL"/>
    </inputPort>
  </targets>
  <transformationSteps xsi:type="etl:Aggregation" name="Aggregation_1" label="Aggregation_1">
    <outputPort name="Aggregation_5out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber" dataTypeDomain="LONG"/>
    </outputPort>
    <inputPort name="Aggregation_5in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber" dataTypeDomain="LONG"/>
    </inputPort>
    <groupByFieldName>businessentityid</groupByFieldName>
    <aggregationParameters resultFieldName="payratenumber" fieldName="payratenumber" aggregationFunction="MAX"/>
  </transformationSteps>
  <transformationSteps xsi:type="etl:Join" name="Join_1" label="Join_1" joinType="LEFT">
    <outputPort name="Join_4out">
      <fields xsi:type="etl:ProjectionField" name="businessentityid" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.1/@inputPort/@fields.0"/>
      <fields xsi:type="etl:ProjectionField" name="payratenumber" dataTypeDomain="LONG" sourceFields="//@transformationSteps.1/@inputPort/@fields.1"/>
      <fields xsi:type="etl:ProjectionField" name="id_2" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.1/@joineePort/@fields.0"/>
      <fields xsi:type="etl:ProjectionField" name="payRateNumber_2" dataTypeDomain="LONG" sourceFields="//@transformationSteps.1/@joineePort/@fields.1"/>
      <fields xsi:type="etl:ProjectionField" name="date_2" dataTypeDomain="DATETIME" sourceFields="//@transformationSteps.1/@joineePort/@fields.2"/>
      <fields xsi:type="etl:ProjectionField" name="rate_2" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.1/@joineePort/@fields.3"/>
    </outputPort>
    <inputPort name="Join_4in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber" dataTypeDomain="LONG"/>
    </inputPort>
    <joineePort name="Join_4join">
      <fields name="id_2" dataTypeDomain="INTEGER"/>
      <fields name="payRateNumber_2" dataTypeDomain="LONG"/>
      <fields name="date_2" dataTypeDomain="DATETIME"/>
      <fields name="rate_2" dataTypeDomain="DECIMAL"/>
    </joineePort>
    <keyFields>businessentityid</keyFields>
    <keyFields>payratenumber</keyFields>
    <joineeKeyFields>id_2</joineeKeyFields>
    <joineeKeyFields>payRateNumber_2</joineeKeyFields>
  </transformationSteps>
  <transformationSteps xsi:type="etl:Projection" name="Projection_1" label="Projection_1">
    <outputPort name="Projection_16out">
      <fields xsi:type="etl:ProjectionField" name="businessentityid" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.2/@inputPort/@fields.2 //@transformationSteps.2/@inputPort/@fields.0"/>
      <fields xsi:type="etl:ProjectionField" name="date" dataTypeDomain="DATETIME" sourceFields="//@transformationSteps.2/@inputPort/@fields.4"/>
      <fields xsi:type="etl:ProjectionField" name="rate" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.2/@inputPort/@fields.5"/>
    </outputPort>
    <inputPort name="Projection_16in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber" dataTypeDomain="LONG"/>
      <fields name="id_2" dataTypeDomain="INTEGER"/>
      <fields name="payRateNumber_2" dataTypeDomain="LONG"/>
      <fields name="date_2" dataTypeDomain="DATETIME"/>
      <fields name="rate_2" dataTypeDomain="DECIMAL"/>
    </inputPort>
  </transformationSteps>
  <transformationSteps xsi:type="etl:SparkSQL" name="Spark_SQL_2" label="Spark_SQL_2" statement="select &#xA;    businessentityid,&#xA;    row_number() OVER (&#xA;        PARTITION BY businessentityid ORDER BY ratechangedate DESC&#xA;    ) payRateNumber&#xA;from sparkTable">
    <outputPort name="Spark_SQL_11out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payRateNumber" dataTypeDomain="INTEGER"/>
    </outputPort>
    <sqlPorts name="sparkTable" alias="sparkTable">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="ratechangedate" dataTypeDomain="DATETIME"/>
    </sqlPorts>
  </transformationSteps>
  <transformationSteps xsi:type="etl:Projection" name="Projection_2" label="Projection_2">
    <outputPort name="Projection_15out">
      <fields xsi:type="etl:ProjectionField" name="businessentityid" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.4/@inputPort/@fields.0"/>
      <fields xsi:type="etl:ProjectionField" name="payRateNumber" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.4/@inputPort/@fields.1" expression="payRateNumber - 1" fieldOperationType="SQL"/>
    </outputPort>
    <inputPort name="Projection_15in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payRateNumber" dataTypeDomain="INTEGER"/>
    </inputPort>
  </transformationSteps>
  <transformationSteps xsi:type="etl:Selection" name="Selection_2" label="Selection_2" expression="payRateNumber &lt;> 0">
    <outputPort name="Selection_17out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payRateNumber" dataTypeDomain="INTEGER"/>
    </outputPort>
    <inputPort name="Selection_17in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payRateNumber" dataTypeDomain="INTEGER"/>
    </inputPort>
  </transformationSteps>
  <transformationSteps xsi:type="etl:Aggregation" name="Aggregation_2" label="Aggregation_2">
    <outputPort name="Aggregation_5out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber" dataTypeDomain="INTEGER"/>
    </outputPort>
    <inputPort name="Aggregation_5in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payRateNumber" dataTypeDomain="INTEGER"/>
    </inputPort>
    <groupByFieldName>businessentityid</groupByFieldName>
    <aggregationParameters resultFieldName="payratenumber" fieldName="payRateNumber" aggregationFunction="MAX"/>
  </transformationSteps>
  <transformationSteps xsi:type="etl:Join" name="Join_2" label="Join_2" joinType="LEFT">
    <outputPort name="Join_4out">
      <fields xsi:type="etl:ProjectionField" name="businessentityid" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.1/@inputPort/@fields.0 //@transformationSteps.7/@inputPort/@fields.0"/>
      <fields xsi:type="etl:ProjectionField" name="payratenumber" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.1/@inputPort/@fields.1 //@transformationSteps.7/@inputPort/@fields.1"/>
      <fields xsi:type="etl:ProjectionField" name="id_2" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.1/@joineePort/@fields.0 //@transformationSteps.7/@joineePort/@fields.0"/>
      <fields xsi:type="etl:ProjectionField" name="date_2" dataTypeDomain="DATETIME" sourceFields="//@transformationSteps.1/@joineePort/@fields.2 //@transformationSteps.7/@joineePort/@fields.2"/>
      <fields xsi:type="etl:ProjectionField" name="rate_2" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.1/@joineePort/@fields.3 //@transformationSteps.7/@joineePort/@fields.3"/>
      <fields xsi:type="etl:ProjectionField" name="payratenumber_2" dataTypeDomain="LONG" sourceFields="//@transformationSteps.7/@joineePort/@fields.1"/>
    </outputPort>
    <inputPort name="Join_4in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber" dataTypeDomain="INTEGER"/>
    </inputPort>
    <joineePort name="Join_4join">
      <fields name="id_2" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber_2" dataTypeDomain="LONG"/>
      <fields name="date_2" dataTypeDomain="DATETIME"/>
      <fields name="rate_2" dataTypeDomain="DECIMAL"/>
    </joineePort>
    <keyFields>businessentityid</keyFields>
    <keyFields>payratenumber</keyFields>
    <joineeKeyFields>id_2</joineeKeyFields>
    <joineeKeyFields>payratenumber_2</joineeKeyFields>
  </transformationSteps>
  <transformationSteps xsi:type="etl:Projection" name="Projection_2_2" label="Projection_2_2">
    <outputPort name="Projection_16out">
      <fields xsi:type="etl:ProjectionField" name="id" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.8/@inputPort/@fields.2"/>
      <fields xsi:type="etl:ProjectionField" name="date" dataTypeDomain="DATETIME" sourceFields="//@transformationSteps.8/@inputPort/@fields.4"/>
      <fields xsi:type="etl:ProjectionField" name="rate" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.8/@inputPort/@fields.5"/>
    </outputPort>
    <inputPort name="Projection_16in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber" dataTypeDomain="INTEGER"/>
      <fields name="id_2" dataTypeDomain="INTEGER"/>
      <fields name="date_2" dataTypeDomain="DATETIME"/>
      <fields name="rate_2" dataTypeDomain="DECIMAL"/>
      <fields name="payratenumber_2" dataTypeDomain="LONG"/>
    </inputPort>
  </transformationSteps>
  <sources xsi:type="etl:SQLSource" name="EmployeePayHistory_1" label="EmployeePayHistory_1" statement="select&#xA;&#x9;businessentityid,&#xA;&#x9;ROW_NUMBER() OVER(PARTITION BY businessentityid ORDER BY ratechangedate DESC) as &#xA;        payRateNumber&#xA;from humanresources.employeepayhistory">
    <outputPort name="SQL_0out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber" dataTypeDomain="LONG"/>
    </outputPort>
  </sources>
  <sources xsi:type="etl:SQLSource" name="EmployeePayHistory_1_2" label="EmployeePayHistory_1_2" statement="select&#xA;&#x9;businessentityid id_2,&#xA;&#x9;ROW_NUMBER() OVER(PARTITION BY businessentityid ORDER BY ratechangedate DESC) as &#xA;        payRateNumber_2,&#xA;&#x9;ratechangedate as date_2,&#xA;        rate as rate_2&#xA;from humanresources.employeepayhistory">
    <outputPort name="SQL_0out">
      <fields name="id_2" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber_2" dataTypeDomain="LONG"/>
      <fields name="date_2" dataTypeDomain="DATETIME"/>
      <fields name="rate_2" dataTypeDomain="DECIMAL"/>
    </outputPort>
  </sources>
  <sources xsi:type="etl:SQLSource" name="EmployeePayHistory_2" label="EmployeePayHistory_2" statement="select&#xA;&#x9;businessentityid,&#xA;        ratechangedate&#xA;from humanresources.employeepayhistory">
    <outputPort name="SQL_0out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="ratechangedate" dataTypeDomain="DATETIME"/>
    </outputPort>
  </sources>
  <sources xsi:type="etl:SQLSource" name="EmployeePayHistory_2_2" label="EmployeePayHistory_2_2" statement="select&#xA;&#x9;businessentityid id_2,&#xA;&#x9;ROW_NUMBER() OVER(PARTITION BY businessentityid ORDER BY ratechangedate DESC) as &#xA;        payRateNumber_2,&#xA;&#x9;ratechangedate as date_2,&#xA;        rate as rate_2&#xA;from humanresources.employeepayhistory">
    <outputPort name="SQL_0out">
      <fields name="id_2" dataTypeDomain="INTEGER"/>
      <fields name="payratenumber_2" dataTypeDomain="LONG"/>
      <fields name="date_2" dataTypeDomain="DATETIME"/>
      <fields name="rate_2" dataTypeDomain="DECIMAL"/>
    </outputPort>
  </sources>
  <transitions name="8aec49dd-6a20-4f7b-aac6-2b8f45712698" start="//@transformationSteps.1/@outputPort" finish="//@transformationSteps.2/@inputPort"/>
  <transitions name="42f3f99d-522a-4e4c-bcea-fa4f20fd8bc9" start="//@transformationSteps.0/@outputPort" finish="//@transformationSteps.1/@inputPort"/>
  <transitions name="7f104682-ae6d-4942-a8aa-e804298cc8a4" start="//@sources.1/@outputPort" finish="//@transformationSteps.1/@joineePort"/>
  <transitions name="db276891-4d37-4c1a-917a-23c6ac249afe" start="//@transformationSteps.2/@outputPort" finish="//@targets.0/@inputPort"/>
  <transitions name="dfb22fd6-46af-48d0-af17-eca172894fc3" start="//@sources.0/@outputPort" finish="//@transformationSteps.0/@inputPort"/>
  <transitions name="3f75ddff-3c62-4207-a9be-395c6b717863" start="//@sources.2/@outputPort" finish="//@transformationSteps.3/@sqlPorts.0"/>
  <transitions name="ff4cf5b9-7ae2-4a84-835d-472dff5e1ce9" start="//@transformationSteps.3/@outputPort" finish="//@transformationSteps.4/@inputPort"/>
  <transitions name="347c093a-56e2-4b39-9818-0d501701879a" start="//@transformationSteps.4/@outputPort" finish="//@transformationSteps.5/@inputPort"/>
  <transitions name="8359d2b4-ec50-4705-b602-903b31d19885" start="//@transformationSteps.5/@outputPort" finish="//@transformationSteps.6/@inputPort"/>
  <transitions name="5cf40eca-df07-4349-8169-8274376b095b" start="//@transformationSteps.6/@outputPort" finish="//@transformationSteps.7/@inputPort"/>
  <transitions name="ca0dcbb3-f574-40c2-ae40-c0a1ba820f2a" start="//@sources.3/@outputPort" finish="//@transformationSteps.7/@joineePort"/>
  <transitions name="42ccbb78-d098-4ae9-aef4-9c6a64f9e4a2" start="//@transformationSteps.7/@outputPort" finish="//@transformationSteps.8/@inputPort"/>
  <auditInfo changeUser="admin" changeDateTime="2021-03-16T15:48:48.853+0000" createUser="admin" createDateTime="2021-03-15T11:09:34.608+0000"/>
</etl:Transformation>
