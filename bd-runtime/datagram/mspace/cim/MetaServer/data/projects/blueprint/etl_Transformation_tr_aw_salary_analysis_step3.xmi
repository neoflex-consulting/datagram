<?xml version="1.0" encoding="ASCII"?>
<etl:Transformation xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:etl="http://www.neoflex.ru/meta/etl" name="tr_aw_salary_analysis_step3" label="tr_aw_salary_analysis_step2" sparkVersion="SPARK3" description="&#x417;&#x430;&#x434;&#x430;&#x447;&#x430;: &#x41f;&#x440;&#x43e;&#x432;&#x435;&#x441;&#x442;&#x438; &#x438;&#x43d;&#x434;&#x435;&#x43a;&#x441;&#x430;&#x446;&#x438;&#x44e; &#x437;&#x430;&#x440;&#x43f;&#x43b;&#x430;&#x442; &#x441; &#x443;&#x447;&#x435;&#x442;&#x43e;&#x43c; &#x431;&#x438;&#x437;&#x43d;&#x435;&#x441; &#x43f;&#x440;&#x430;&#x432;&#x438;&#x43b;.&#xA;&#x412;&#x440;&#x435;&#x43c;&#x44f; &#x43f;&#x440;&#x43e;&#x432;&#x435;&#x434;&#x435;&#x43d;&#x438;&#x44f;: &#x434;&#x435;&#x43a;&#x430;&#x431;&#x440;&#x44c; 2013 &#x433;&#x43e;&#x434;&#x430;&#xA;&#xA;&#x41f;&#x440;&#x430;&#x432;&#x438;&#x43b;&#x430; &#x431;&#x438;&#x437;&#x43d;&#x435;&#x441;&#x430;:&#xA;1. &#x41f;&#x43e;&#x432;&#x44b;&#x448;&#x430;&#x442;&#x44c; &#x417;&#x41f; &#x43c;&#x430;&#x43a;&#x441;&#x438;&#x43c;&#x443;&#x43c; 2 &#x440;&#x430;&#x437;&#x430; &#x432; &#x433;&#x43e;&#x434;&#xA;2. &#x41c;&#x430;&#x43a;&#x441;&#x438;&#x43c;&#x430;&#x43b;&#x44c;&#x43d;&#x43e;&#x435; &#x43f;&#x43e;&#x432;&#x44b;&#x448;&#x435;&#x43d;&#x438;&#x435; &#x417;&#x41f; 30% &#x432; &#x433;&#x43e;&#x434;&#xA;3. &#x412; &#x441;&#x43b;&#x443;&#x447;&#x430;&#x435; &#x43d;&#x435;&#x441;&#x43e;&#x431;&#x43b;&#x44e;&#x434;&#x435;&#x43d;&#x438;&#x44f; &#x43f;&#x440;&#x430;&#x432;&#x438;&#x43b; 1 &#x438;&#x43b;&#x438; 2, &#x43d;&#x435;&#x43e;&#x431;&#x445;&#x43e;&#x434;&#x438;&#x43c;&#x43e; &#x441;&#x43e;&#x433;&#x43b;&#x430;&#x441;&#x43e;&#x432;&#x430;&#x43d;&#x438;&#x435; &#x440;&#x443;&#x43a;&#x43e;&#x432;&#x43e;&#x434;&#x438;&#x442;&#x435;&#x43b;&#x44f; &#x43a;&#x43e;&#x43c;&#x43f;&#x430;&#x43d;&#x438;&#x438;.&#xA;&#xA;&#x412; Step 3: &#x424;&#x43e;&#x440;&#x43c;&#x438;&#x440;&#x43e;&#x432;&#x430;&#x43d;&#x438;&#x435; &#x438;&#x442;&#x43e;&#x433;&#x43e;&#x432;&#x43e;&#x439; &#x442;&#x430;&#x431;&#x43b;&#x438;&#x446;&#x44b;" jsonView="{&quot;cells&quot;:[{&quot;type&quot;:&quot;devs.transformation.HiveSource&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:120,&quot;y&quot;:300},&quot;angle&quot;:0,&quot;id&quot;:&quot;59abc868-493a-418a-adbd-6aa2f0171d82&quot;,&quot;name&quot;:&quot;Hive_1&quot;,&quot;z&quot;:1,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Hive_1&quot;}}},{&quot;type&quot;:&quot;devs.transformation.SqlSource&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:120,&quot;y&quot;:90},&quot;angle&quot;:0,&quot;id&quot;:&quot;aaf343ba-2827-4e63-a05d-79b140048e6a&quot;,&quot;name&quot;:&quot;SQL_5&quot;,&quot;z&quot;:2,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;SQL_5&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Join&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;,&quot;join&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;join&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;join&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:330,&quot;y&quot;:210},&quot;angle&quot;:0,&quot;id&quot;:&quot;379fb434-3d92-4f06-a2c0-dfd3c41b61f7&quot;,&quot;name&quot;:&quot;Join_2&quot;,&quot;z&quot;:3,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Join_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Projection&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:480,&quot;y&quot;:210},&quot;angle&quot;:0,&quot;id&quot;:&quot;fccb7168-dbcf-470b-8fc8-9b883dd67284&quot;,&quot;name&quot;:&quot;Projection_5&quot;,&quot;z&quot;:4,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Projection_5&quot;}}},{&quot;type&quot;:&quot;devs.transformation.CSVTarget&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:660,&quot;y&quot;:210},&quot;angle&quot;:0,&quot;id&quot;:&quot;f88e39c6-e996-46e3-b64c-54b516d66620&quot;,&quot;name&quot;:&quot;CSV_7&quot;,&quot;z&quot;:5,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;CSV_7&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;aaf343ba-2827-4e63-a05d-79b140048e6a&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;379fb434-3d92-4f06-a2c0-dfd3c41b61f7&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;4de6aed9-b2b2-421e-a6d8-0b4cddd158af&quot;,&quot;z&quot;:6,&quot;name&quot;:&quot;774966aa-63fe-40e2-879a-35caf86e7428&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;774966aa-63fe-40e2-879a-35caf86e7428&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;59abc868-493a-418a-adbd-6aa2f0171d82&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;379fb434-3d92-4f06-a2c0-dfd3c41b61f7&quot;,&quot;port&quot;:&quot;join&quot;},&quot;id&quot;:&quot;9f8d44cc-b797-4646-9ab3-c75a0b842ffa&quot;,&quot;z&quot;:7,&quot;name&quot;:&quot;2c6c5cac-8abb-4f51-8b94-830c7a9aa2ce&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;2c6c5cac-8abb-4f51-8b94-830c7a9aa2ce&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;379fb434-3d92-4f06-a2c0-dfd3c41b61f7&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;fccb7168-dbcf-470b-8fc8-9b883dd67284&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;f8cc3211-202a-4c70-a7af-621c9d6f001f&quot;,&quot;z&quot;:8,&quot;name&quot;:&quot;8cf8897b-7c08-4976-8550-ae2a3669dddb&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;8cf8897b-7c08-4976-8550-ae2a3669dddb&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;fccb7168-dbcf-470b-8fc8-9b883dd67284&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;f88e39c6-e996-46e3-b64c-54b516d66620&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;553690c4-fd8b-4590-9891-b60002f76ce3&quot;,&quot;z&quot;:9,&quot;name&quot;:&quot;b1e76a88-010d-4fd6-82c6-31a5ccb0626c&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;b1e76a88-010d-4fd6-82c6-31a5ccb0626c&quot;}}}]}">
  <targets xsi:type="etl:CSVTarget" name="CSV_7" label="CSV_7" csvFormat="EXCEL" path="/tmp/salary/salary_analysis_final.xls" header="true" quote="&quot;" escape="\">
    <inputPort name="CSV_7in">
      <fields name="name" dataTypeDomain="STRING"/>
      <fields name="date_last" dataTypeDomain="DATETIME"/>
      <fields name="rate_last" dataTypeDomain="DECIMAL"/>
      <fields name="date_previous" dataTypeDomain="DATETIME"/>
      <fields name="rate_previous" dataTypeDomain="DECIMAL"/>
      <fields name="salaryincrease" dataTypeDomain="DECIMAL"/>
    </inputPort>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="name" targetColumnName="name"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="date_last" targetColumnName="date_last"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="rate_last" targetColumnName="rate_last"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="date_previous" targetColumnName="date_previous"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="rate_previous" targetColumnName="rate_previous"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="salaryincrease" targetColumnName="salaryincrease"/>
  </targets>
  <transformationSteps xsi:type="etl:Join" name="Join_2" label="Join_2" joinType="LEFT">
    <outputPort name="Join_2out">
      <fields xsi:type="etl:ProjectionField" name="businessentityid" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.0/@inputPort/@fields.0"/>
      <fields xsi:type="etl:ProjectionField" name="name" dataTypeDomain="STRING" sourceFields="//@transformationSteps.0/@inputPort/@fields.1"/>
      <fields xsi:type="etl:ProjectionField" name="date_last" dataTypeDomain="DATETIME" sourceFields="//@transformationSteps.0/@joineePort/@fields.1"/>
      <fields xsi:type="etl:ProjectionField" name="rate_last" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.0/@joineePort/@fields.2"/>
      <fields xsi:type="etl:ProjectionField" name="date_previous" dataTypeDomain="DATETIME" sourceFields="//@transformationSteps.0/@joineePort/@fields.3"/>
      <fields xsi:type="etl:ProjectionField" name="rate_previous" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.0/@joineePort/@fields.4"/>
      <fields xsi:type="etl:ProjectionField" name="salaryincrease" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.0/@joineePort/@fields.5"/>
    </outputPort>
    <inputPort name="Join_2in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="name" dataTypeDomain="STRING"/>
    </inputPort>
    <joineePort name="Join_2join">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="date_last" dataTypeDomain="DATETIME"/>
      <fields name="rate_last" dataTypeDomain="DECIMAL"/>
      <fields name="date_previous" dataTypeDomain="DATETIME"/>
      <fields name="rate_previous" dataTypeDomain="DECIMAL"/>
      <fields name="salaryincrease" dataTypeDomain="DECIMAL"/>
    </joineePort>
    <keyFields>businessentityid</keyFields>
    <joineeKeyFields>businessentityid</joineeKeyFields>
  </transformationSteps>
  <transformationSteps xsi:type="etl:Projection" name="Projection_5" label="Projection_5">
    <outputPort name="Projection_5out">
      <fields xsi:type="etl:ProjectionField" name="name" dataTypeDomain="STRING" sourceFields="//@transformationSteps.1/@inputPort/@fields.1"/>
      <fields xsi:type="etl:ProjectionField" name="date_last" dataTypeDomain="DATETIME" sourceFields="//@transformationSteps.1/@inputPort/@fields.2"/>
      <fields xsi:type="etl:ProjectionField" name="rate_last" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.1/@inputPort/@fields.3"/>
      <fields xsi:type="etl:ProjectionField" name="date_previous" dataTypeDomain="DATETIME" sourceFields="//@transformationSteps.1/@inputPort/@fields.4"/>
      <fields xsi:type="etl:ProjectionField" name="rate_previous" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.1/@inputPort/@fields.5"/>
      <fields xsi:type="etl:ProjectionField" name="salaryincrease" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.1/@inputPort/@fields.6" expression="if(salaryincrease is null, 30, salaryincrease)" fieldOperationType="SQL"/>
    </outputPort>
    <inputPort name="Projection_5in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="name" dataTypeDomain="STRING"/>
      <fields name="date_last" dataTypeDomain="DATETIME"/>
      <fields name="rate_last" dataTypeDomain="DECIMAL"/>
      <fields name="date_previous" dataTypeDomain="DATETIME"/>
      <fields name="rate_previous" dataTypeDomain="DECIMAL"/>
      <fields name="salaryincrease" dataTypeDomain="DECIMAL"/>
    </inputPort>
  </transformationSteps>
  <sources xsi:type="etl:HiveSource" name="Hive_1" label="Hive_1" statement="select * from salary_analysis_3">
    <outputPort name="Hive_0out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="date_last" dataTypeDomain="DATETIME"/>
      <fields name="rate_last" dataTypeDomain="DECIMAL"/>
      <fields name="date_previous" dataTypeDomain="DATETIME"/>
      <fields name="rate_previous" dataTypeDomain="DECIMAL"/>
      <fields name="salaryincrease" dataTypeDomain="DECIMAL"/>
    </outputPort>
  </sources>
  <sources xsi:type="etl:SQLSource" name="SQL_5" label="SQL_5" statement="select&#xD;&#xA;&#x9;businessentityid,&#xD;&#xA;&#x9;concat(firstname, ' ', middlename, ' ', lastname) as name&#xD;&#xA;from person.person">
    <outputPort name="SQL_5out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="name" dataTypeDomain="STRING"/>
    </outputPort>
  </sources>
  <transitions name="774966aa-63fe-40e2-879a-35caf86e7428" start="//@sources.1/@outputPort" finish="//@transformationSteps.0/@inputPort"/>
  <transitions name="2c6c5cac-8abb-4f51-8b94-830c7a9aa2ce" start="//@sources.0/@outputPort" finish="//@transformationSteps.0/@joineePort"/>
  <transitions name="8cf8897b-7c08-4976-8550-ae2a3669dddb" start="//@transformationSteps.0/@outputPort" finish="//@transformationSteps.1/@inputPort"/>
  <transitions name="b1e76a88-010d-4fd6-82c6-31a5ccb0626c" start="//@transformationSteps.1/@outputPort" finish="//@targets.0/@inputPort"/>
  <auditInfo changeUser="admin" changeDateTime="2021-03-23T11:06:13.140+0000" createUser="admin" createDateTime="2021-03-18T13:50:52.649+0000"/>
</etl:Transformation>
