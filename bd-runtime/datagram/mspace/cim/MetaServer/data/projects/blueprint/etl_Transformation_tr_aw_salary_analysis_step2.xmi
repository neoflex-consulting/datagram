<?xml version="1.0" encoding="ASCII"?>
<etl:Transformation xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:etl="http://www.neoflex.ru/meta/etl" name="tr_aw_salary_analysis_step2" label="tr_aw_salary_analysis_step2" sparkVersion="SPARK3" description="&#x427;&#x442;&#x43e;&#x431;&#x44b; &#x43f;&#x43e;&#x441;&#x43c;&#x43e;&#x442;&#x440;&#x435;&#x442;&#x44c; &#x432;&#x441;&#x435; &#x442;&#x430;&#x431;&#x43b;&#x438;&#x446;&#x44b; &#x432; Hive, &#x43d;&#x443;&#x436;&#x43d;&#x43e; &#x432; Livy &#x432;&#x432;&#x435;&#x441;&#x442;&#x438; &#x43a;&#x43e;&#x43c;&#x430;&#x43d;&#x434;&#x443;: &quot;spark.sql(&quot;show tables&quot;).show()&quot;" jsonView="{&quot;cells&quot;:[{&quot;type&quot;:&quot;devs.transformation.HiveSource&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:120,&quot;y&quot;:90},&quot;angle&quot;:0,&quot;id&quot;:&quot;b06d0eeb-f41e-46cd-a378-a4c6bc14d871&quot;,&quot;name&quot;:&quot;Hive_1&quot;,&quot;z&quot;:1,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Hive_1&quot;}}},{&quot;type&quot;:&quot;devs.transformation.HiveSource&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:120,&quot;y&quot;:270},&quot;angle&quot;:0,&quot;id&quot;:&quot;a6e0e978-3335-4db4-8983-5d60ff31d759&quot;,&quot;name&quot;:&quot;Hive_2&quot;,&quot;z&quot;:2,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Hive_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.SqlSource&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:300,&quot;y&quot;:360},&quot;angle&quot;:0,&quot;id&quot;:&quot;e7f80300-74f5-4c9d-9916-99fcec887e14&quot;,&quot;name&quot;:&quot;SQL_5&quot;,&quot;z&quot;:3,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;SQL_5&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Join&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;,&quot;join&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;join&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;join&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:300,&quot;y&quot;:180},&quot;angle&quot;:0,&quot;id&quot;:&quot;1868c1d3-4059-4e22-be37-3a8a00ce1281&quot;,&quot;name&quot;:&quot;Join_2&quot;,&quot;z&quot;:4,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;Join_2&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;b06d0eeb-f41e-46cd-a378-a4c6bc14d871&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;1868c1d3-4059-4e22-be37-3a8a00ce1281&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;e470f1d0-945d-425d-b535-61670dc4cfcc&quot;,&quot;z&quot;:5,&quot;name&quot;:&quot;46997632-2151-4677-ab70-a302b8dbbbd6&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;46997632-2151-4677-ab70-a302b8dbbbd6&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;a6e0e978-3335-4db4-8983-5d60ff31d759&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;1868c1d3-4059-4e22-be37-3a8a00ce1281&quot;,&quot;port&quot;:&quot;join&quot;},&quot;id&quot;:&quot;66ffafc5-1afd-4f2b-96a8-36f743a715c5&quot;,&quot;z&quot;:6,&quot;name&quot;:&quot;defa7d65-c64f-4f6d-8108-146954fa3891&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;defa7d65-c64f-4f6d-8108-146954fa3891&quot;}}}]}">
  <transformationSteps xsi:type="etl:Join" name="Join_2" label="Join_2" joinType="LEFT">
    <outputPort name="Join_2out">
      <fields xsi:type="etl:ProjectionField" name="businessentityid" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.0/@inputPort/@fields.0"/>
      <fields xsi:type="etl:ProjectionField" name="date_last" dataTypeDomain="DATETIME" sourceFields="//@transformationSteps.0/@inputPort/@fields.1"/>
      <fields xsi:type="etl:ProjectionField" name="rate_last" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.0/@inputPort/@fields.2"/>
      <fields xsi:type="etl:ProjectionField" name="date_previous" dataTypeDomain="DATETIME" sourceFields="//@transformationSteps.0/@joineePort/@fields.1"/>
      <fields xsi:type="etl:ProjectionField" name="rate_previous" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.0/@joineePort/@fields.2"/>
    </outputPort>
    <inputPort name="Join_2in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="date_last" dataTypeDomain="DATETIME"/>
      <fields name="rate_last" dataTypeDomain="DECIMAL"/>
    </inputPort>
    <joineePort name="Join_2join">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="date_previous" dataTypeDomain="DATETIME"/>
      <fields name="rate_previous" dataTypeDomain="DECIMAL"/>
    </joineePort>
    <keyFields>businessentityid</keyFields>
    <joineeKeyFields>businessentityid</joineeKeyFields>
  </transformationSteps>
  <sources xsi:type="etl:HiveSource" name="Hive_1" label="Hive_1" statement="select * from salary_analysis">
    <outputPort name="Hive_0out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="date_last" dataTypeDomain="DATETIME"/>
      <fields name="rate_last" dataTypeDomain="DECIMAL"/>
    </outputPort>
  </sources>
  <sources xsi:type="etl:HiveSource" name="Hive_2" label="Hive_2" statement="select * from salary_analysis_2">
    <outputPort name="Hive_0out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="date_previous" dataTypeDomain="DATETIME"/>
      <fields name="rate_previous" dataTypeDomain="DECIMAL"/>
    </outputPort>
  </sources>
  <sources xsi:type="etl:SQLSource" name="SQL_5" label="SQL_5" statement="select&#xD;&#xA;&#x9;businessentityid,&#xD;&#xA;&#x9;firstname,&#xD;&#xA;&#x9;middlename,&#xD;&#xA;&#x9;lastname&#xD;&#xA;from person.person">
    <outputPort name="SQL_5out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="firstname" dataTypeDomain="STRING"/>
      <fields name="middlename" dataTypeDomain="STRING"/>
      <fields name="lastname" dataTypeDomain="STRING"/>
    </outputPort>
  </sources>
  <transitions name="46997632-2151-4677-ab70-a302b8dbbbd6" start="//@sources.0/@outputPort" finish="//@transformationSteps.0/@inputPort"/>
  <transitions name="defa7d65-c64f-4f6d-8108-146954fa3891" start="//@sources.1/@outputPort" finish="//@transformationSteps.0/@joineePort"/>
  <auditInfo changeUser="admin" changeDateTime="2021-03-19T14:26:55.110+0000" createUser="admin" createDateTime="2021-03-18T13:50:52.649+0000"/>
</etl:Transformation>
