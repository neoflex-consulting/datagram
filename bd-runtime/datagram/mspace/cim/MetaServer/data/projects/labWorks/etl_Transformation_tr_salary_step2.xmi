<?xml version="1.0" encoding="ASCII"?>
<etl:Transformation xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:etl="http://www.neoflex.ru/meta/etl" name="tr_salary_step2" label="tr_salary_step2" sparkVersion="SPARK3" description="&#x424;&#x43e;&#x440;&#x43c;&#x438;&#x440;&#x43e;&#x432;&#x430;&#x43d;&#x438;&#x435; &#x442;&#x430;&#x431;&#x43b;&#x438;&#x446; &#x43f;&#x43b;&#x430;&#x43d;&#x430; &#x43f;&#x43e;&#x432;&#x44b;&#x448;&#x435;&#x43d;&#x438;&#x44f; &#x417;&#x41f; &#x431;&#x435;&#x437; &#x43a;&#x43e;&#x43d;&#x444;&#x43b;&#x438;&#x43a;&#x442;&#x43e;&#x432; &#x438; &#x441; &#x43a;&#x43e;&#x43d;&#x444;&#x43b;&#x438;&#x43a;&#x442;&#x430;&#x43c;&#x438;" jsonView="{&quot;cells&quot;:[{&quot;type&quot;:&quot;devs.transformation.HiveSource&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:150,&quot;y&quot;:330},&quot;angle&quot;:0,&quot;id&quot;:&quot;d7995575-e814-4b67-8c53-f25c165777e4&quot;,&quot;name&quot;:&quot;hiveSalary&quot;,&quot;z&quot;:1,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;hiveSalary&quot;}}},{&quot;type&quot;:&quot;devs.transformation.SqlSource&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:420,&quot;y&quot;:120},&quot;angle&quot;:0,&quot;id&quot;:&quot;2522dcc7-e8e1-445e-bff2-cfa40e4c41fc&quot;,&quot;name&quot;:&quot;person&quot;,&quot;z&quot;:2,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;person&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Aggregation&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:300,&quot;y&quot;:330},&quot;angle&quot;:0,&quot;id&quot;:&quot;9b63b478-8fdf-4cfd-ad62-4a356f164445&quot;,&quot;name&quot;:&quot;sumUpSalary&quot;,&quot;z&quot;:3,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;sumUpSalary&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Projection&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:450,&quot;y&quot;:330},&quot;angle&quot;:0,&quot;id&quot;:&quot;4241bcae-7a3b-4304-be01-3f702d8b653b&quot;,&quot;name&quot;:&quot;excessSumAndCount&quot;,&quot;z&quot;:4,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;excessSumAndCount&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Join&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;,&quot;join&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;join&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;join&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:600,&quot;y&quot;:210},&quot;angle&quot;:0,&quot;id&quot;:&quot;e2336d4f-2755-4744-b4de-0db0f25d912a&quot;,&quot;name&quot;:&quot;tableFactUp&quot;,&quot;z&quot;:5,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;tableFactUp&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Selection&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[&quot;out&quot;],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}},{&quot;id&quot;:&quot;out&quot;,&quot;group&quot;:&quot;out&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;out&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:780,&quot;y&quot;:120},&quot;angle&quot;:0,&quot;id&quot;:&quot;aab8343e-a302-4a9d-8c9c-776cffe16648&quot;,&quot;name&quot;:&quot;selectNotExcessSum&quot;,&quot;z&quot;:6,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;selectNotExcessSum&quot;}}},{&quot;type&quot;:&quot;devs.transformation.LocalTarget&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:780,&quot;y&quot;:330},&quot;angle&quot;:0,&quot;id&quot;:&quot;f8c2942f-5213-4236-aa1b-71ddfd1bf43c&quot;,&quot;name&quot;:&quot;tableUpSalary&quot;,&quot;z&quot;:7,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;tableUpSalary&quot;}}},{&quot;type&quot;:&quot;devs.transformation.LocalTarget&quot;,&quot;size&quot;:{&quot;width&quot;:80,&quot;height&quot;:80},&quot;inPorts&quot;:[&quot;in&quot;],&quot;outPorts&quot;:[],&quot;ports&quot;:{&quot;groups&quot;:{&quot;in&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;white&quot;,&quot;magnet&quot;:&quot;passive&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;left&quot;,&quot;args&quot;:{&quot;y&quot;:10}}}},&quot;out&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;},&quot;label&quot;:{&quot;position&quot;:{&quot;name&quot;:&quot;right&quot;,&quot;args&quot;:{&quot;y&quot;:10}}},&quot;attrs&quot;:{&quot;.port-body&quot;:{&quot;fill&quot;:&quot;#4d4d4dde&quot;,&quot;stroke&quot;:&quot;#000&quot;,&quot;r&quot;:10,&quot;magnet&quot;:true},&quot;.port-label&quot;:{&quot;text&quot;:&quot;&quot;,&quot;visibility&quot;:&quot;hidden&quot;,&quot;fill&quot;:&quot;#000&quot;},&quot;circle&quot;:{&quot;r&quot;:7,&quot;stroke&quot;:&quot;#4d4d4dde&quot;,&quot;stroke-width&quot;:1}}}},&quot;items&quot;:[{&quot;id&quot;:&quot;in&quot;,&quot;group&quot;:&quot;in&quot;,&quot;attrs&quot;:{&quot;.port-label&quot;:{&quot;text&quot;:&quot;in&quot;}}}]},&quot;position&quot;:{&quot;x&quot;:930,&quot;y&quot;:120},&quot;angle&quot;:0,&quot;id&quot;:&quot;d8a29705-7326-432e-a899-edc3e61c7f1d&quot;,&quot;name&quot;:&quot;tableUpSalaryConflict&quot;,&quot;z&quot;:8,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;tableUpSalaryConflict&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;d7995575-e814-4b67-8c53-f25c165777e4&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;9b63b478-8fdf-4cfd-ad62-4a356f164445&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;bc6ff061-0524-4936-8f6e-540b35669df5&quot;,&quot;z&quot;:9,&quot;name&quot;:&quot;f705529b-2822-43eb-9822-fe21433dca9f&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;f705529b-2822-43eb-9822-fe21433dca9f&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;9b63b478-8fdf-4cfd-ad62-4a356f164445&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;4241bcae-7a3b-4304-be01-3f702d8b653b&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;12635103-6db1-4c80-a27d-589c8baadbb8&quot;,&quot;z&quot;:10,&quot;name&quot;:&quot;7889f4d9-0965-414b-a191-bed7facfea40&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;7889f4d9-0965-414b-a191-bed7facfea40&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;2522dcc7-e8e1-445e-bff2-cfa40e4c41fc&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;e2336d4f-2755-4744-b4de-0db0f25d912a&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;9e18458f-c1bf-4bd3-8242-d845a5cd6e56&quot;,&quot;z&quot;:11,&quot;name&quot;:&quot;c5b39cbf-4c79-4b9c-8f51-aa9264fcd3ac&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;c5b39cbf-4c79-4b9c-8f51-aa9264fcd3ac&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;4241bcae-7a3b-4304-be01-3f702d8b653b&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;e2336d4f-2755-4744-b4de-0db0f25d912a&quot;,&quot;port&quot;:&quot;join&quot;},&quot;id&quot;:&quot;70517dc8-f161-4397-a881-133dd2de59bd&quot;,&quot;z&quot;:12,&quot;name&quot;:&quot;3af50743-9a6c-4cd5-9bfe-13c53efb54cb&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;3af50743-9a6c-4cd5-9bfe-13c53efb54cb&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;e2336d4f-2755-4744-b4de-0db0f25d912a&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;aab8343e-a302-4a9d-8c9c-776cffe16648&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;42d0aad7-e0a2-46ae-ac2b-eb7db4bfb173&quot;,&quot;z&quot;:13,&quot;name&quot;:&quot;a2ee84aa-c2fd-4fe3-9036-8f5d093bfbc5&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;a2ee84aa-c2fd-4fe3-9036-8f5d093bfbc5&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;aab8343e-a302-4a9d-8c9c-776cffe16648&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;d8a29705-7326-432e-a899-edc3e61c7f1d&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;4f07188a-728a-4178-89d7-05db4ae9e65a&quot;,&quot;z&quot;:14,&quot;name&quot;:&quot;35c62a31-2924-4fab-af7d-38939fb695eb&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;35c62a31-2924-4fab-af7d-38939fb695eb&quot;}}},{&quot;type&quot;:&quot;devs.transformation.Flow&quot;,&quot;source&quot;:{&quot;id&quot;:&quot;e2336d4f-2755-4744-b4de-0db0f25d912a&quot;,&quot;port&quot;:&quot;out&quot;},&quot;target&quot;:{&quot;id&quot;:&quot;f8c2942f-5213-4236-aa1b-71ddfd1bf43c&quot;,&quot;port&quot;:&quot;in&quot;},&quot;id&quot;:&quot;3f3e45bf-f57d-4874-a7a8-0549fa3f3d8b&quot;,&quot;z&quot;:15,&quot;name&quot;:&quot;c6ac36f3-e471-4213-aee6-501c84d475d0&quot;,&quot;attrs&quot;:{&quot;.label&quot;:{&quot;text&quot;:&quot;c6ac36f3-e471-4213-aee6-501c84d475d0&quot;}}}]}">
  <targets xsi:type="etl:LocalTarget" name="tableUpSalary" label="tableUpSalary" localFileName="/tmp/salary/tableUpSalary" localFileFormat="PARQUET" saveMode="OVERWRITE" registerTable="true" hiveTableName="tableUpSalary">
    <inputPort name="Local_9in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="personName" dataTypeDomain="STRING"/>
      <fields name="sumUpSalary" dataTypeDomain="DECIMAL"/>
      <fields name="countUpSalary" dataTypeDomain="DECIMAL"/>
      <fields name="excessSum" dataTypeDomain="BOOLEAN"/>
      <fields name="excessCount" dataTypeDomain="BOOLEAN"/>
      <fields name="newSum" dataTypeDomain="DECIMAL"/>
    </inputPort>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="businessentityid" targetColumnName="businessentityid"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="personName" targetColumnName="personName"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="sumUpSalary" targetColumnName="sumUpSalary"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="countUpSalary" targetColumnName="countUpSalary"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="excessSum" targetColumnName="excessSum"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="excessCount" targetColumnName="excessCount"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="newSum" targetColumnName="newSum"/>
    <options key="compression" value="gzip"/>
  </targets>
  <targets xsi:type="etl:LocalTarget" name="tableUpSalaryConflict" label="tableUpSalaryConflict" localFileName="/tmp/salary/tableUpSalaryConflict" localFileFormat="PARQUET" saveMode="OVERWRITE" registerTable="true" hiveTableName="tableUpSalaryConflict">
    <inputPort name="Local_13in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="personName" dataTypeDomain="STRING"/>
      <fields name="sumUpSalary" dataTypeDomain="DECIMAL"/>
      <fields name="countUpSalary" dataTypeDomain="DECIMAL"/>
      <fields name="excessSum" dataTypeDomain="BOOLEAN"/>
      <fields name="excessCount" dataTypeDomain="BOOLEAN"/>
      <fields name="newSum" dataTypeDomain="DECIMAL"/>
    </inputPort>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="businessentityid" targetColumnName="businessentityid"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="personName" targetColumnName="personName"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="sumUpSalary" targetColumnName="sumUpSalary"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="countUpSalary" targetColumnName="countUpSalary"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="excessSum" targetColumnName="excessSum"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="excessCount" targetColumnName="excessCount"/>
    <inputFieldsMapping xsi:type="etl:TableTargetFeature" inputFieldName="newSum" targetColumnName="newSum"/>
    <options key="compression" value="gzip"/>
  </targets>
  <transformationSteps xsi:type="etl:Aggregation" name="sumUpSalary" label="sumUpSalary">
    <outputPort name="Aggregation_6out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="sumUpSalary" dataTypeDomain="DECIMAL"/>
      <fields name="countUpSalary" dataTypeDomain="DECIMAL"/>
    </outputPort>
    <inputPort name="Aggregation_6in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="rate" dataTypeDomain="DECIMAL"/>
      <fields name="ratechangedate" dataTypeDomain="DATETIME"/>
      <fields name="personname" dataTypeDomain="STRING"/>
    </inputPort>
    <groupByFieldName>businessentityid</groupByFieldName>
    <aggregationParameters resultFieldName="sumUpSalary" fieldName="rate"/>
    <aggregationParameters resultFieldName="countUpSalary" fieldName="rate" aggregationFunction="COUNT"/>
  </transformationSteps>
  <transformationSteps xsi:type="etl:Projection" name="excessSumAndCount" label="excessSumAndCount">
    <outputPort name="Projection_4out">
      <fields xsi:type="etl:ProjectionField" name="businessentityid" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.1/@inputPort/@fields.0"/>
      <fields xsi:type="etl:ProjectionField" name="sumUpSalary" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.1/@inputPort/@fields.1" expression="&quot;&quot;sumUpSalary"/>
      <fields xsi:type="etl:ProjectionField" name="countUpSalary" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.1/@inputPort/@fields.2" expression="&quot;&quot;countUpSalary"/>
      <fields xsi:type="etl:ProjectionField" name="excessSum" dataTypeDomain="BOOLEAN" sourceFields="//@transformationSteps.1/@inputPort/@fields.1" expression="sumUpSalary >= cast('${jobParameters(&quot;maxRate&quot;)}' as integer)" fieldOperationType="SQL"/>
      <fields xsi:type="etl:ProjectionField" name="excessCount" dataTypeDomain="BOOLEAN" sourceFields="//@transformationSteps.1/@inputPort/@fields.2" expression="true" fieldOperationType="SQL"/>
      <fields xsi:type="etl:ProjectionField" name="maxRate" dataTypeDomain="STRING" expression="cast('${jobParameters(&quot;maxRate&quot;)}' as integer)" fieldOperationType="SQL"/>
    </outputPort>
    <inputPort name="Projection_4in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="sumUpSalary" dataTypeDomain="DECIMAL"/>
      <fields name="countUpSalary" dataTypeDomain="DECIMAL"/>
    </inputPort>
  </transformationSteps>
  <transformationSteps xsi:type="etl:Join" name="tableFactUp" label="tableFactUp" checkpoint="true" joinType="LEFT">
    <outputPort name="Join_6out">
      <fields xsi:type="etl:ProjectionField" name="businessentityid" dataTypeDomain="INTEGER" sourceFields="//@transformationSteps.2/@inputPort/@fields.0"/>
      <fields xsi:type="etl:ProjectionField" name="personName" dataTypeDomain="STRING" sourceFields="//@transformationSteps.2/@inputPort/@fields.1 //@transformationSteps.2/@inputPort/@fields.2 //@transformationSteps.2/@inputPort/@fields.3" expression="concat( &#xA;    if(_1.firstname is null, '', _1.firstname), &#xA;    ' ', &#xA;    if(_1.middlename is null, '', _1.middlename), &#xA;    ' ',&#xA;    if(_1.lastname is null, '', _1.lastname) &#xA;)" fieldOperationType="SQL"/>
      <fields xsi:type="etl:ProjectionField" name="sumUpSalary" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.2/@joineePort/@fields.1"/>
      <fields xsi:type="etl:ProjectionField" name="countUpSalary" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.2/@joineePort/@fields.2"/>
      <fields xsi:type="etl:ProjectionField" name="excessSum" dataTypeDomain="BOOLEAN" sourceFields="//@transformationSteps.2/@joineePort/@fields.3 //@transformationSteps.2/@joineePort/@fields.1" expression="_2.excessSum is not null&#xA;    AND&#xA;_2.sumUpSalary >= 20" fieldOperationType="SQL"/>
      <fields xsi:type="etl:ProjectionField" name="excessCount" dataTypeDomain="BOOLEAN" sourceFields="//@transformationSteps.2/@joineePort/@fields.4" expression="_2.excessCount is not null" fieldOperationType="SQL"/>
      <fields xsi:type="etl:ProjectionField" name="newSum" dataTypeDomain="DECIMAL" sourceFields="//@transformationSteps.2/@joineePort/@fields.1 //@transformationSteps.2/@joineePort/@fields.5" expression="if(&#xA;    _2.sumUpSalary is null,&#xA;        20,&#xA;        if(&#xA;            _2.sumUpSalary >= _2.maxRate,&#xA;            0,&#xA;            _2.sumUpSalary&#xA;        )&#xA;    &#xA;)" fieldOperationType="SQL"/>
    </outputPort>
    <inputPort name="Join_6in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="firstname" dataTypeDomain="STRING"/>
      <fields name="lastname" dataTypeDomain="STRING"/>
      <fields name="middlename" dataTypeDomain="STRING"/>
    </inputPort>
    <joineePort name="Join_6join">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="sumUpSalary" dataTypeDomain="DECIMAL"/>
      <fields name="countUpSalary" dataTypeDomain="DECIMAL"/>
      <fields name="excessSum" dataTypeDomain="BOOLEAN"/>
      <fields name="excessCount" dataTypeDomain="BOOLEAN"/>
      <fields name="maxRate" dataTypeDomain="STRING"/>
    </joineePort>
    <keyFields>businessentityid</keyFields>
    <joineeKeyFields>businessentityid</joineeKeyFields>
  </transformationSteps>
  <transformationSteps xsi:type="etl:Selection" name="selectNotExcessSum" label="selectNotExcessSum" expression="excessSum == false AND excessCount == true">
    <outputPort name="Selection_11out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="personName" dataTypeDomain="STRING"/>
      <fields name="sumUpSalary" dataTypeDomain="DECIMAL"/>
      <fields name="countUpSalary" dataTypeDomain="DECIMAL"/>
      <fields name="excessSum" dataTypeDomain="BOOLEAN"/>
      <fields name="excessCount" dataTypeDomain="BOOLEAN"/>
      <fields name="newSum" dataTypeDomain="DECIMAL"/>
    </outputPort>
    <inputPort name="Selection_11in">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="personName" dataTypeDomain="STRING"/>
      <fields name="sumUpSalary" dataTypeDomain="DECIMAL"/>
      <fields name="countUpSalary" dataTypeDomain="DECIMAL"/>
      <fields name="excessSum" dataTypeDomain="BOOLEAN"/>
      <fields name="excessCount" dataTypeDomain="BOOLEAN"/>
      <fields name="newSum" dataTypeDomain="DECIMAL"/>
    </inputPort>
  </transformationSteps>
  <sources xsi:type="etl:HiveSource" name="hiveSalary" label="hiveSalary" checkpoint="true" statement="select * from lastyearsalary">
    <outputPort name="Hive_0out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="rate" dataTypeDomain="DECIMAL"/>
      <fields name="ratechangedate" dataTypeDomain="DATETIME"/>
      <fields name="personname" dataTypeDomain="STRING"/>
    </outputPort>
  </sources>
  <sources xsi:type="etl:SQLSource" name="person" label="person" statement="select&#xD;&#xA;&#x9;businessentityid,&#xD;&#xA;&#x9;firstname,&#xD;&#xA;&#x9;lastname,&#xD;&#xA;&#x9;middlename&#xD;&#xA;from person.person">
    <outputPort name="SQL_1out">
      <fields name="businessentityid" dataTypeDomain="INTEGER"/>
      <fields name="firstname" dataTypeDomain="STRING"/>
      <fields name="lastname" dataTypeDomain="STRING"/>
      <fields name="middlename" dataTypeDomain="STRING"/>
    </outputPort>
  </sources>
  <transitions name="f705529b-2822-43eb-9822-fe21433dca9f" start="//@sources.0/@outputPort" finish="//@transformationSteps.0/@inputPort"/>
  <transitions name="7889f4d9-0965-414b-a191-bed7facfea40" start="//@transformationSteps.0/@outputPort" finish="//@transformationSteps.1/@inputPort"/>
  <transitions name="c5b39cbf-4c79-4b9c-8f51-aa9264fcd3ac" start="//@sources.1/@outputPort" finish="//@transformationSteps.2/@inputPort"/>
  <transitions name="3af50743-9a6c-4cd5-9bfe-13c53efb54cb" start="//@transformationSteps.1/@outputPort" finish="//@transformationSteps.2/@joineePort"/>
  <transitions name="a2ee84aa-c2fd-4fe3-9036-8f5d093bfbc5" start="//@transformationSteps.2/@outputPort" finish="//@transformationSteps.3/@inputPort"/>
  <transitions name="35c62a31-2924-4fab-af7d-38939fb695eb" start="//@transformationSteps.3/@outputPort" finish="//@targets.1/@inputPort"/>
  <transitions name="c6ac36f3-e471-4213-aee6-501c84d475d0" start="//@transformationSteps.2/@outputPort" finish="//@targets.0/@inputPort"/>
  <auditInfo changeUser="admin" changeDateTime="2021-04-06T12:05:23.019+0000" createUser="admin" createDateTime="2021-03-31T14:56:10.731+0000"/>
</etl:Transformation>
